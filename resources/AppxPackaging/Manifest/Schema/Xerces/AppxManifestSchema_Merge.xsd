<?xml version="1.0" encoding="utf-8"?>
<!--

  !!!WARNING!!!
  This manifest is a merge between:
    - FoundationManifestSchema.xsd
    - FoundationManifestSchema_v2.xsd
    - DesktopManifestSchema.xsd
    - DesktopManifestSchema_v2.xsd
    - DesktopManifestSchema_v3.xsd
    - DesktopManifestSchema_v4.xsd
    - DesktopManifestSchema_v5.xsd
    - DesktopManifestSchema_v6.xsd
    - RestrictedCapabilitiesManifestSchema.xsd
    - RestrictedCapabilitiesManifestSchema_v3.xsd
    - ComManifestSchema.xsd
    - ComManifestSchema_v2.xsd
    - UapManifestSchema.xsd
    - UapManifestSchema_v2.xsd
    - UapManifestSchema_v3.xsd
    - UapManifestSchema_v4.xsd
    - UapManifestSchema_v5.xsd
    - UapManifestSchema_v6.xsd
    - UapManifestSchema_v7.xsd
    - UapManifestSchema_v8.xsd
    - WindowsCapabilitiesManifestSchema.xsd
    - WindowsCapabilitiesManifestSchema_v3.xsd
    - IotManifestSchema_v2.xsd
    - HolographicManifestSchema.xsd
    - IotManifestSchema.xsd
    - MobileManifestSchema.xsd
    - RestrictedCapabilitiesManifestSchema_v2.xsd
    - ServerManifestSchema.xsd
    - WindowsCapabilitiesManifestSchema_v2.xsd
    - RestrictedCapabilitiesManifestSchema_v4.xsd

  Don't make any changes to this schema.

-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified"
           xmlns:xs="http://www.w3.org/2001/XMLSchema"
           targetNamespace="http://schemas.microsoft.com/appx/manifest/foundation/windows10"
           xmlns="http://schemas.microsoft.com/appx/manifest/foundation/windows10"
           xmlns:t="http://schemas.microsoft.com/appx/manifest/types"
           xmlns:f="http://schemas.microsoft.com/appx/manifest/foundation/windows10"
           xmlns:f2="http://schemas.microsoft.com/appx/manifest/foundation/windows10/2"
           xmlns:uap="http://schemas.microsoft.com/appx/manifest/uap/windows10"
           xmlns:uap2="http://schemas.microsoft.com/appx/manifest/uap/windows10/2"
           xmlns:uap3="http://schemas.microsoft.com/appx/manifest/uap/windows10/3"
           xmlns:uap4="http://schemas.microsoft.com/appx/manifest/uap/windows10/4"
           xmlns:uap5="http://schemas.microsoft.com/appx/manifest/uap/windows10/5"
           xmlns:uap6="http://schemas.microsoft.com/appx/manifest/uap/windows10/6"
           xmlns:uap7="http://schemas.microsoft.com/appx/manifest/uap/windows10/7"
           xmlns:uap8="http://schemas.microsoft.com/appx/manifest/uap/windows10/8"
           xmlns:wincap="http://schemas.microsoft.com/appx/manifest/foundation/windows10/windowscapabilities"
           xmlns:wincap3="http://schemas.microsoft.com/appx/manifest/foundation/windows10/windowscapabilities/3"
           xmlns:rescap="http://schemas.microsoft.com/appx/manifest/foundation/windows10/restrictedcapabilities"
           xmlns:rescap3="http://schemas.microsoft.com/appx/manifest/foundation/windows10/restrictedcapabilities/3"
           xmlns:rescap5="http://schemas.microsoft.com/appx/manifest/foundation/windows10/restrictedcapabilities/5"
           xmlns:rescap6="http://schemas.microsoft.com/appx/manifest/foundation/windows10/restrictedcapabilities/6"
           xmlns:phone="http://schemas.microsoft.com/appx/2014/phone/manifest"
           xmlns:iot2="http://schemas.microsoft.com/appx/manifest/iot/windows10/2"
           xmlns:com="http://schemas.microsoft.com/appx/manifest/com/windows10"
           xmlns:com2="http://schemas.microsoft.com/appx/manifest/com/windows10/2"
           xmlns:desktop="http://schemas.microsoft.com/appx/manifest/desktop/windows10"
           xmlns:desktop2="http://schemas.microsoft.com/appx/manifest/desktop/windows10/2"
           xmlns:desktop3="http://schemas.microsoft.com/appx/manifest/desktop/windows10/3"
           xmlns:desktop4="http://schemas.microsoft.com/appx/manifest/desktop/windows10/4"
           xmlns:desktop5="http://schemas.microsoft.com/appx/manifest/desktop/windows10/5"
           xmlns:desktop6="http://schemas.microsoft.com/appx/manifest/desktop/windows10/6"
           xmlns:holo="http://schemas.microsoft.com/appx/manifest/holographic/windows10"
           xmlns:iot="http://schemas.microsoft.com/appx/manifest/iot/windows10"
           xmlns:mobile="http://schemas.microsoft.com/appx/manifest/mobile/windows10"
           xmlns:rescap2="http://schemas.microsoft.com/appx/manifest/foundation/windows10/restrictedcapabilities/2"
           xmlns:serverpreview="http://schemas.microsoft.com/appx/manifest/serverpreview/windows10"
           xmlns:wincap2="http://schemas.microsoft.com/appx/manifest/foundation/windows10/windowscapabilities/2"
           xmlns:rescap4="http://schemas.microsoft.com/appx/manifest/foundation/windows10/restrictedcapabilities/4"
           >

  <xs:import namespace="http://schemas.microsoft.com/appx/manifest/types"/>
  <xs:import namespace="http://schemas.microsoft.com/appx/2014/phone/manifest"/>
  <xs:import namespace="http://schemas.microsoft.com/appx/manifest/foundation/windows10/restrictedcapabilities/5"/>
  <xs:import namespace="http://schemas.microsoft.com/appx/manifest/foundation/windows10/restrictedcapabilities/6"/>

  <!-- FoundationManifestSchema.xsd -->
  <xs:element name="Package">
    <xs:complexType>
      <xs:all>
        <xs:element name="Identity" type="CT_Identity"/>
        <xs:element ref="phone:PhoneIdentity" minOccurs="0"/>
        <xs:element name="Properties" type="CT_Properties"/>
        <xs:element name="Resources" type="CT_Resources" minOccurs="0"/>
        <xs:element name="Dependencies" type="CT_Dependencies"/>
        <xs:element name="Capabilities" type="CT_Capabilities" minOccurs="0"/>
        <xs:element name="Extensions" type="CT_PackageExtensions" minOccurs="0"/>
        <xs:element name="Applications" type="CT_Applications" minOccurs="0"/>
        <xs:element ref="ComExtensions" minOccurs="0"/>
      </xs:all>
      <xs:attribute name="IgnorableNamespaces" type="t:ST_NonEmptyString" use="optional"/>
    </xs:complexType>
    <xs:unique name="Resource_Language">
      <xs:selector xpath="f:Resources/f:Resource"/>
      <xs:field xpath="@Language"/>
    </xs:unique>
    <xs:unique name="Resource_Scale">
      <xs:selector xpath="f:Resources/f:Resource"/>
      <xs:field xpath="@uap:Scale"/>
    </xs:unique>
    <xs:unique name="Resource_DXFeatureLevel">
      <xs:selector xpath="f:Resources/f:Resource"/>
      <xs:field xpath="@uap:DXFeatureLevel"/>
    </xs:unique>
    <xs:unique name="Application_Id">
      <xs:selector xpath="f:Applications/f:Application"/>
      <xs:field xpath="@Id"/>
    </xs:unique>
    <xs:unique name="Capability_Name">
      <xs:selector xpath="f:Capabilities/f:Capability | f:Capabilities/uap:Capability | f:Capabilities/wincap:Capability | f:Capabilities/rescap:Capability"/>
      <xs:field xpath="@Name"/>
    </xs:unique>
    <xs:unique name="DeviceCapability_Name">
      <xs:selector xpath="f:Capabilities/f:DeviceCapability"/>
      <xs:field xpath="@Name"/>
    </xs:unique>
    <xs:unique name="CustomCapability_Name">
      <xs:selector xpath="f:Capabilities/uap4:CustomCapability"/>
      <xs:field xpath="@Name"/>
    </xs:unique>
    <xs:unique name="Extension_FileType_Name">
      <xs:selector xpath="f:Applications/f:Application/f:Extensions/uap:Extension/uap:FileTypeAssociation"/>
      <xs:field xpath="@Name"/>
    </xs:unique>
    <xs:unique name="Extension_FileType">
      <xs:selector xpath="f:Applications/f:Application/f:Extensions/uap:Extension/uap:FileTypeAssociation/uap:SupportedFileTypes/uap:FileType"/>
      <xs:field xpath="."/>
    </xs:unique>
    <xs:unique name="Extension_Protocol">
      <xs:selector xpath="f:Applications/f:Application/f:Extensions/uap:Extension/uap:Protocol"/>
      <xs:field xpath="@Name"/>
    </xs:unique>
    <xs:unique name="Extension_DialProtocol">
      <xs:selector xpath="f:Applications/f:Application/f:Extensions/uap:Extension/uap:DialProtocol"/>
      <xs:field xpath="@Name"/>
    </xs:unique>
    <xs:unique name="Extension_StartupTask">
      <xs:selector xpath="f:Applications/f:Application/f:Extensions/desktop:Extension/desktop:StartupTask"/>
      <xs:field xpath="@TaskId"/>
    </xs:unique>
    <xs:unique name="Extension_AppExecutionAlias">
      <xs:selector xpath="f:Applications/f:Application/f:Extensions/uap3:Extension/uap3:AppExecutionAlias/desktop:ExecutionAlias | f:Applications/f:Application/f:Extensions/uap3:Extension/uap3:AppExecutionAlias/uap8:ExecutionAlias | f:Applications/f:Application/f:Extensions/uap5:Extension/uap5:AppExecutionAlias/uap5:ExecutionAlias |
      f:Applications/f:Application/f:Extensions/uap5:Extension/uap5:AppExecutionAlias/uap8:ExecutionAlias"/>
      <xs:field xpath="@Alias"/>
    </xs:unique>
    <xs:unique name="Class_Id">
      <xs:selector xpath="f:Applications/f:Application/f:Extensions/com:Extension/com:ComServer/com:ExeServer/com:Class | f:Applications/f:Application/f:Extensions/com:Extension/com:ComServer/com:SurrogateServer/com:Class | f:Applications/f:Application/f:Extensions/com:Extension/com:ComServer/com:TreatAsClass | f:Applications/f:Application/f:Extensions/com:Extension/com:ComInterface/com:ProxyStub | f:Extensions/com:Extension/com:ComInterface/com:ProxyStub | f:Applications/f:Application/f:Extensions/com2:Extension/com2:ComServer/com:ExeServer/com:Class | f:Applications/f:Application/f:Extensions/com2:Extension/com2:ComServer/com:SurrogateServer/com:Class | f:Applications/f:Application/f:Extensions/com2:Extension/com2:ComServer/com:TreatAsClass | f:Applications/f:Application/f:Extensions/com2:Extension/com2:ComInterface/com:ProxyStub | f:Extensions/com2:Extension/com2:ComInterface/com:ProxyStub"/>
      <xs:field xpath="@Id"/>
    </xs:unique>
    <xs:unique name="ProgId_Id">
      <xs:selector xpath="f:Applications/f:Application/f:Extensions/com:Extension/com:ComServer/com:ProgId | f:Applications/f:Application/f:Extensions/com2:Extension/com2:ComServer/com:ProgId"/>
      <xs:field xpath="@Id"/>
    </xs:unique>
    <xs:unique name="Interface_Id">
      <xs:selector xpath="f:Applications/f:Application/f:Extensions/com:Extension/com:ComInterface/com:Interface | f:Extensions/com:Extension/com:ComInterface/com:Interface | f:Applications/f:Application/f:Extensions/com2:Extension/com2:ComInterface/com:Interface | f:Extensions/com2:Extension/com2:ComInterface/com:Interface"/>
      <xs:field xpath="@Id"/>
    </xs:unique>
    <xs:unique name="TypeLib_Id">
      <xs:selector xpath="f:Applications/f:Application/f:Extensions/com:Extension/com:ComInterface/com:TypeLib | f:Extensions/com:Extension/com:ComInterface/com:TypeLib | f:Applications/f:Application/f:Extensions/com2:Extension/com2:ComInterface/com:TypeLib | f:Extensions/com2:Extension/com2:ComInterface/com:TypeLib"/>
      <xs:field xpath="@Id"/>
    </xs:unique>
    <xs:unique name="SurrogateServer_AppId">
      <xs:selector xpath="f:Applications/f:Application/f:Extensions/com:Extension/com:ComServer/com:SurrogateServer | f:Applications/f:Application/f:Extensions/com2:Extension/com2:ComServer/com:SurrogateServer"/>
      <xs:field xpath="@AppId"/>
    </xs:unique>
    <xs:unique name="Extension_AppUriHandlerName">
      <xs:selector xpath="f:Applications/f:Application/f:Extensions/uap3:Extension/uap3:AppUriHandler"/>
      <xs:field xpath="@uap7:Name"/>
    </xs:unique>
  </xs:element>

  <xs:element name="ComExtensions" abstract="true"/>

  <xs:complexType name="CT_Identity">
    <xs:attribute name="Name" type="t:ST_PackageName" use="required"/>
    <xs:attribute name="ProcessorArchitecture" type="t:ST_Architecture_v2" use="optional"/>
    <xs:attribute name="Publisher" type="t:ST_Publisher_2010_v2" use="required"/>
    <xs:attribute name="Version" type="t:ST_VersionQuad" use="required"/>
    <xs:attribute name="ResourceId" type="t:ST_ResourceId" use="optional"/>
  </xs:complexType>

  <xs:complexType name="CT_Properties">
    <xs:all>
      <xs:element name="Framework" type="xs:boolean" minOccurs="0"/>
      <xs:element name="DisplayName" type="t:ST_DisplayName"/>
      <xs:element name="PublisherDisplayName" type="t:ST_DisplayName"/>
      <xs:element name="Description" type="t:ST_Description" minOccurs="0"/>
      <xs:element name="Logo" type="t:ST_ImageFile"/>
      <xs:element name="ResourcePackage" type="xs:boolean" minOccurs="0"/>
      <xs:element ref="uap:SupportedUsers" minOccurs="0"/>
      <xs:element ref="uap6:AllowExecution" minOccurs="0"/>
      <xs:element ref="desktop6:RegistryWriteVirtualization" minOccurs="0"/>
      <xs:element ref="desktop6:FileSystemWriteVirtualization" minOccurs="0"/>
      <xs:element ref="rescap6:ModificationPackage" minOccurs="0"/>
    </xs:all>
  </xs:complexType>

  <xs:complexType name="CT_Resources">
    <xs:sequence>
      <xs:element name="Resource" minOccurs="0" maxOccurs="200">
        <xs:complexType>
          <xs:attribute name="Language" type="xs:language" use="optional"/>
          <xs:attribute ref="uap:Scale" use="optional"/>
          <xs:attribute ref="uap:DXFeatureLevel" use="optional"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="CT_Dependencies">
    <xs:sequence>
      <xs:element name="TargetDeviceFamily" maxOccurs="128">
        <xs:complexType>
          <xs:attribute name="Name" type="t:ST_AsciiIdentifier" use="required"/>
          <xs:attribute name="MinVersion" type="t:ST_VersionQuad" use="required"/>
          <xs:attribute name="MaxVersionTested" type="t:ST_VersionQuad" use="required"/>
        </xs:complexType>
      </xs:element>
      <xs:element name="PackageDependency" minOccurs="0" maxOccurs="128">
        <xs:complexType>
          <xs:attribute name="Name" type="t:ST_PackageName" use="required"/>
          <xs:attribute name="Publisher" type="t:ST_Publisher_2010_v2" use="required"/>
          <xs:attribute name="MinVersion" type="t:ST_VersionQuad" use="required"/>
          <xs:attribute name="MaxMajorVersionTested" type="xs:unsignedShort" use="optional"/>
          <xs:attribute ref="uap6:Optional" use="optional"/>
        </xs:complexType>
      </xs:element>
      <xs:element ref="MainPackageDependencyChoice" minOccurs="0" maxOccurs="1"/>
      <xs:element ref="MainPackageDependencyChoice2" minOccurs="0" maxOccurs="1000"/>
      <xs:element ref="uap5:DriverDependency" minOccurs="0" maxOccurs="1000"/>
      <xs:element ref="uap7:OSPackageDependency" minOccurs="0" maxOccurs="1000"/>
    </xs:sequence>
  </xs:complexType>

  <xs:element name="MainPackageDependencyChoice" abstract="true"/>
  <xs:element name="MainPackageDependencyChoice2" abstract="true"/>

  <xs:complexType name="CT_Capabilities">
    <xs:sequence>
      <xs:element ref="CapabilityChoice" minOccurs="0" maxOccurs="100"/>
      <xs:element ref="CustomCapabilityChoice" minOccurs="0" maxOccurs="1000"/>
      <xs:element ref="DeviceCapability" minOccurs="0" maxOccurs="1000"/>
    </xs:sequence>
  </xs:complexType>

  <xs:element name="CapabilityChoice" abstract="true"/>
  <xs:element name="Capability" substitutionGroup="CapabilityChoice">
    <xs:complexType>
      <xs:attribute name="Name" type="t:ST_Capability_Foundation" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="CustomCapabilityChoice" abstract="true"/>

  <xs:element name="DeviceCapability">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="Device" type="CT_Device" minOccurs="0" maxOccurs="100"/>
        <xs:element ref="AdditionalDeviceChoice" minOccurs="0" maxOccurs="10000"/>
      </xs:sequence>
      <xs:attribute name="Name" type="t:ST_DeviceCapability" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="AdditionalDeviceChoice" abstract="true"/>

  <xs:complexType name="CT_Device">
    <xs:sequence>
      <xs:element name="Function" maxOccurs="100">
        <xs:complexType>
          <xs:attribute name="Type" type="t:ST_DeviceFunction_Foundation" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="Id" type="t:ST_DeviceId" use="required"/>
  </xs:complexType>

  <xs:complexType name="CT_PackageExtensions">
    <xs:choice minOccurs="0" maxOccurs="10000">
      <xs:element name="Extension" maxOccurs="10000">
        <xs:complexType>
          <xs:choice>
            <xs:element name="InProcessServer" type="CT_InProcessServer"/>
            <xs:element name="OutOfProcessServer" type="CT_OutOfProcessServer"/>
            <xs:element name="ProxyStub" type="CT_ProxyStub"/>
            <xs:element name="Certificates" type="CT_Certificates"/>
            <xs:element name="PublisherCacheFolders" type="CT_PublisherCacheFolders"/>
          </xs:choice>
          <xs:attribute name="Category" type="t:ST_PackageExtensionCategory_Foundation" use="required"/>
        </xs:complexType>
      </xs:element>
      <xs:element ref="ExtensionChoice"/>
    </xs:choice>
  </xs:complexType>

  <xs:complexType name="CT_InProcessServer">
    <xs:sequence>
      <xs:element name="Path" type="t:ST_FileName"/>
      <xs:element name="ActivatableClass" type="CT_InProcessActivatableClass" maxOccurs="65535"/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="CT_InProcessActivatableClass">
    <xs:sequence>
      <xs:element name="ActivatableClassAttribute" type="t:CT_ActivatableClassAttribute" minOccurs="0" maxOccurs="1000"/>
    </xs:sequence>
    <xs:attribute name="ActivatableClassId" type="t:ST_ActivatableClassId" use="required"/>
    <xs:attribute name="ThreadingModel" type="t:ST_ThreadingModel" use="required"/>
  </xs:complexType>

  <xs:complexType name="CT_OutOfProcessServer">
    <xs:sequence>
      <xs:element name="Path" type="t:ST_ExecutableAnyCase"/>
      <xs:element name="Arguments" type="t:ST_NonEmptyString" minOccurs="0"/>
      <xs:element name="Instancing" type="t:ST_Instancing"/>
      <xs:element name="ActivatableClass" type="CT_OutOfProcessActivatableClass" maxOccurs="65535"/>
    </xs:sequence>
    <xs:attribute name="ServerName" type="t:ST_AsciiWindowsId" use="required"/>
    <xs:attributeGroup ref="uap5:OutOfProcessServerFullTrustAttributes"/>
  </xs:complexType>

  <xs:complexType name="CT_OutOfProcessActivatableClass">
    <xs:sequence>
      <xs:element name="ActivatableClassAttribute" type="t:CT_ActivatableClassAttribute" minOccurs="0" maxOccurs="1000"/>
    </xs:sequence>
    <xs:attribute name="ActivatableClassId" type="t:ST_ActivatableClassId" use="required"/>
  </xs:complexType>

  <xs:complexType name="CT_ProxyStub">
    <xs:sequence>
      <xs:element name="Path" type="t:ST_FileName" />
      <xs:element name="Interface" type="t:CT_Interface_Foundation" maxOccurs="65535"/>
    </xs:sequence>
    <xs:attribute name="ClassId" type="t:ST_GUID" use="required"/>
  </xs:complexType>

  <xs:complexType name="CT_Certificates">
    <xs:sequence>
      <xs:element name="Certificate" type="t:CT_CertificateContent" minOccurs="0" maxOccurs="100"/>
      <xs:element name="TrustFlags" type="t:CT_CertificateTrustFlags" minOccurs="0"/>
      <xs:element name="SelectionCriteria" type="t:CT_CertificateSelectionCriteria" minOccurs="0"/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="CT_PublisherCacheFolders">
    <xs:sequence>
      <xs:element name="Folder" minOccurs="1" maxOccurs="100">
        <xs:complexType>
          <xs:attribute name="Name" type="t:ST_FileNameSegment" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="CT_Applications">
    <xs:sequence>
      <xs:element name="Application" maxOccurs="100">
        <xs:complexType>
          <xs:all>
            <xs:element ref="VisualElementsChoice"/>
            <xs:element ref="uap:ApplicationContentUriRules" minOccurs="0"/>
            <xs:element name="Extensions" type="CT_ApplicationExtensions" minOccurs="0"/>
            <xs:element ref="uap7:Properties" minOccurs="0"/>
          </xs:all>
          <xs:attribute name="Id" type="t:ST_ApplicationId" use="required"/>
          <xs:attribute name="Executable" type="t:ST_ExecutableAnyCase" use="optional"/>
          <xs:attribute name="EntryPoint" type="t:ST_EntryPoint" use="optional"/>
          <xs:attribute name="StartPage" type="t:ST_ApplicationStartPage" use="optional"/>
          <xs:attribute name="ResourceGroup" type="t:ST_AsciiWindowsId" use="optional"/>
          <xs:attribute ref="desktop4:Subsystem" use="optional"/>
          <xs:attribute ref="iot2:Subsystem" use="optional"/>
          <xs:attribute ref="desktop4:SupportsMultipleInstances" use="optional"/>
          <xs:attribute ref="iot2:SupportsMultipleInstances" use="optional"/>
        </xs:complexType>
        <xs:unique name="ApplicationContentUrisRule_Match">
          <xs:selector xpath="uap:ApplicationContentUriRules/uap:Rule"/>
          <xs:field xpath="@Match"/>
        </xs:unique>
        <xs:unique name="ShareTarget_FileType">
          <xs:selector xpath="f:Extensions/uap:Extension/uap:ShareTarget/uap:SupportedFileTypes/uap:FileType"/>
          <xs:field xpath="."/>
        </xs:unique>
        <xs:unique name="ShareTarget_DataFormat">
          <xs:selector xpath="f:Extensions/uap:Extension/uap:ShareTarget/uap:DataFormat"/>
          <xs:field xpath="."/>
        </xs:unique>
        <xs:unique name="FileOpenPicker_FileType">
          <xs:selector xpath="f:Extensions/uap:Extension/uap:FileOpenPicker/uap:SupportedFileTypes/uap:FileType"/>
          <xs:field xpath="."/>
        </xs:unique>
        <xs:unique name="FileSavePicker_FileType">
          <xs:selector xpath="f:Extensions/uap:Extension/uap:FileSavePicker/uap:SupportedFileTypes/uap:FileType"/>
          <xs:field xpath="."/>
        </xs:unique>
        <xs:unique name="AutoPlay_ContentVerb">
          <xs:selector xpath="f:Extensions/uap:Extension/uap:AutoPlayContent/uap:LaunchAction"/>
          <xs:field xpath="@Verb"/>
        </xs:unique>
        <xs:unique name="AutoPlay_DeviceVerb">
          <xs:selector xpath="f:Extensions/uap:Extension/uap:AutoPlayDevice/uap:LaunchAction"/>
          <xs:field xpath="@Verb"/>
        </xs:unique>
        <xs:unique name="MediaCodec_AppServiceName">
          <xs:selector xpath="f:Extensions/uap4:Extension/uap4:MediaCodec"/>
          <xs:field xpath="@AppServiceName"/>
        </xs:unique>
        <xs:key name="ComServer_Class_IdKey">
          <xs:selector xpath="f:Extensions/com:Extension/com:ComServer/com:SurrogateServer/com:Class | f:Extensions/com:Extension/com:ComServer/com:ExeServer/com:Class | f:Extensions/com:Extension/com:ComServer/com:TreatAsClass | f:Extensions/com2:Extension/com2:ComServer/com:SurrogateServer/com:Class | f:Extensions/com2:Extension/com2:ComServer/com:ExeServer/com:Class | f:Extensions/com2:Extension/com2:ComServer/com:TreatAsClass"/>
          <xs:field xpath="@Id"/>
        </xs:key>
        <xs:key name="ComServer_SurrogateServer_Class_IdKey">
          <xs:selector xpath="f:Extensions/com:Extension/com:ComServer/com:SurrogateServer/com:Class | f:Extensions/com2:Extension/com2:ComServer/com:SurrogateServer/com:Class"/>
          <xs:field xpath="@Id"/>
        </xs:key>
        <xs:keyref name="ThumbnailHandlerRef" refer="ComServer_SurrogateServer_Class_IdKey">
          <xs:selector xpath="f:Extensions/uap:Extension/uap:FileTypeAssociation/desktop2:ThumbnailHandler | f:Extensions/uap:Extension/uap3:FileTypeAssociation/desktop2:ThumbnailHandler | f:Extensions/uap3:Extension/uap3:FileTypeAssociation/desktop2:ThumbnailHandler"/>
          <xs:field xpath="@Clsid"/>
        </xs:keyref>
        <xs:keyref name="DesktopPreviewHandlerRef" refer="ComServer_Class_IdKey">
          <xs:selector xpath="f:Extensions/uap:Extension/uap:FileTypeAssociation/desktop2:DesktopPreviewHandler | f:Extensions/uap:Extension/uap3:FileTypeAssociation/desktop2:DesktopPreviewHandler | f:Extensions/uap3:Extension/uap3:FileTypeAssociation/desktop2:DesktopPreviewHandler"/>
          <xs:field xpath="@Clsid"/>
        </xs:keyref>
        <xs:keyref name="DesktopPropertyHandlerRef" refer="ComServer_SurrogateServer_Class_IdKey">
          <xs:selector xpath="f:Extensions/uap:Extension/uap:FileTypeAssociation/desktop2:DesktopPropertyHandler | f:Extensions/uap:Extension/uap3:FileTypeAssociation/desktop2:DesktopPropertyHandler | f:Extensions/uap3:Extension/uap3:FileTypeAssociation/desktop2:DesktopPropertyHandler"/>
          <xs:field xpath="@Clsid"/>
        </xs:keyref>
        <xs:keyref name="OleClassRef" refer="ComServer_Class_IdKey">
          <xs:selector xpath="f:Extensions/uap:Extension/uap:FileTypeAssociation/desktop2:OleClass | f:Extensions/uap:Extension/uap3:FileTypeAssociation/desktop2:OleClass | f:Extensions/uap3:Extension/uap3:FileTypeAssociation/desktop2:OleClass"/>
          <xs:field xpath="@Clsid"/>
        </xs:keyref>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:element name="VisualElementsChoice" abstract="true"/>

  <xs:complexType name="CT_ApplicationExtensions">
    <xs:choice minOccurs="0" maxOccurs="10000">
      <xs:element ref="ApplicationExtensionChoice"/>
      <xs:element ref="ExtensionChoice"/>
    </xs:choice>
  </xs:complexType>

  <xs:element name="ExtensionChoice" abstract="true"/>
  <xs:element name="ApplicationExtensionChoice" abstract="true"/>
  <xs:element name="Extension" substitutionGroup="ApplicationExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="BackgroundTasks" type="CT_BackgroundTasks"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ApplicationExtensionCategory_Foundation" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
    <xs:unique name="BackgroundTasks_Type">
      <xs:selector xpath="f:BackgroundTasks/f:Task | f:BackgroundTasks/uap:Task"/>
      <xs:field xpath="@Type"/>
    </xs:unique>
  </xs:element>

  <xs:complexType name="CT_BackgroundTasks">
    <xs:sequence>
      <xs:element ref="BackgroundTaskChoice" minOccurs="0" maxOccurs="17"/>
    </xs:sequence>
    <xs:attribute name="ServerName" type="t:ST_AsciiWindowsId" use="optional"/>
    <xs:attribute ref="uap4:SupportsMultipleInstances" use="optional"/>
  </xs:complexType>

  <xs:element name="BackgroundTaskChoice" abstract="true"/>
  <xs:element name="Task" substitutionGroup="BackgroundTaskChoice">
    <xs:complexType>
      <xs:attribute name="Type" type="t:ST_BackgroundTasks_Foundation" use="required"/>
    </xs:complexType>
  </xs:element>

  <!-- FoundationManifestSchema_v2.xsd -->
  <xs:element name="f2:Device" type="f2:CT_Device" substitutionGroup="f:AdditionalDeviceChoice"/>

  <xs:complexType name="f2:CT_Device">
    <xs:sequence>
      <xs:element name="f2:Function" maxOccurs="10000">
        <xs:complexType>
          <xs:attribute name="Type" type="t:ST_DeviceFunction_Foundation" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="Id" type="t:ST_DeviceId" use="required"/>
  </xs:complexType>

  <!-- DesktopManifestSchema.xsd -->
  <xs:element name="desktop:Extension" substitutionGroup="f:ApplicationExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="desktop:FullTrustProcess" type="desktop:CT_FullTrustProcess"/>
        <xs:element name="desktop:StartupTask" type="desktop:CT_StartupTask"/>
        <xs:element name="desktop:ToastNotificationActivation" type="desktop:CT_ToastNotificationActivation"/>
        <xs:element name="desktop:SearchProtocolHandler" type="desktop:CT_SearchProtocolHandler"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ApplicationExtensionCategory_Desktop" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
    <xs:unique name="FullTrustProcessParameterGroup_GroupId">
      <xs:selector xpath="desktop:FullTrustProcess/desktop:ParameterGroup"/>
      <xs:field xpath="@GroupId"/>
    </xs:unique>
  </xs:element>

  <xs:complexType name="desktop:CT_FullTrustProcess">
    <xs:sequence>
      <xs:element name="desktop:ParameterGroup" minOccurs="0" maxOccurs="1000">
        <xs:complexType>
          <xs:attribute name="GroupId" type="xs:string" use="required"/>
          <xs:attribute name="Parameters" type="xs:string" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="desktop:CT_StartupTask">
    <xs:attribute name="TaskId" type="t:ST_NonEmptyString" use="required"/>
    <xs:attribute name="Enabled" type="xs:boolean" use="optional"/>
    <xs:attribute name="DisplayName" type="t:ST_DisplayName" use="optional"/>
    <xs:attribute ref="rescap5:ImmediateRegistration" use="optional"/>
  </xs:complexType>

  <xs:complexType name="desktop:CT_ToastNotificationActivation">
    <xs:attribute name="ToastActivatorCLSID" type="t:ST_GUID" use="required"/>
  </xs:complexType>

  <xs:complexType name="desktop:CT_SearchProtocolHandler">
    <xs:sequence>
      <xs:element name="desktop:SearchProtocol" maxOccurs="100">
        <xs:complexType>
          <xs:attribute name="ProtocolName" type="t:ST_AlphaNumericString" use="required"/>
          <xs:attribute name="ProtocolActivatorCLSID" type="t:ST_GUID" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:element name="desktop:ExecutionAlias" substitutionGroup="uap3:ExecutionAliasChoice">
    <xs:complexType>
      <xs:attribute name="Alias" type="t:ST_ExecutableNoPath" use="required"/>
      <xs:attribute ref="uap8:AllowOverride" use="optional"/>
    </xs:complexType>
  </xs:element>

  <!-- DesktopManifestSchema_v2.xsd -->
  <xs:element name="desktop2:Extension" substitutionGroup="f:ExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="desktop2:AppPrinter" type="desktop2:CT_AppPrinter"/>
        <xs:element name="desktop2:SearchFilterHandler" type="desktop2:CT_SearchFilterHandler"/>
        <xs:element name="desktop2:SearchPropertyHandler" type="desktop2:CT_SearchPropertyHandler"/>
        <xs:element name="desktop2:DesktopEventLogging" type="desktop2:CT_DesktopEventLogging"/>
        <xs:element name="desktop2:FirewallRules" type="desktop2:CT_FirewallRules"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ExtensionCategory_Desktop2" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="desktop2:CT_AppPrinter">
    <xs:attribute name="DisplayName" type="t:ST_DisplayName" use="required"/>
    <xs:attribute name="Parameters" type="t:ST_NonEmptyString" use="required"/>
  </xs:complexType>

  <xs:complexType name="desktop2:CT_SearchFilterHandler">
    <xs:sequence>
      <xs:element name="desktop2:FilterExtension" minOccurs="0" maxOccurs="10000" type="t:ST_FileType" />
    </xs:sequence>
    <xs:attribute name="Clsid" type="t:ST_GUID" use="required"/>
    <xs:attribute name="Path" type="t:ST_DllFile"/>
    <xs:attribute name="ProcessorArchitecture" type="t:ST_Architecture"/>
  </xs:complexType>

  <xs:complexType name="desktop2:CT_SearchPropertyHandler">
    <xs:attribute name="Clsid" type="t:ST_GUID" use="required"/>
    <xs:attribute name="Path" type="t:ST_DllFile" use="required"/>
    <xs:attribute name="ProcessorArchitecture" type="t:ST_Architecture" use="required"/>
  </xs:complexType>

  <xs:attribute name="desktop2:UseUrl" type="xs:boolean"/>
  <xs:attribute name="desktop2:AllowSilentDefaultTakeOver" type="xs:boolean"/>
  <xs:attribute name="desktop2:Parameters" type="t:ST_Parameters"/>

  <xs:element name="desktop2:ThumbnailHandler">
    <xs:complexType>
      <xs:attribute name="Clsid" type="t:ST_GUID" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="desktop2:DesktopPreviewHandler">
    <xs:complexType>
      <xs:attribute name="Clsid" type="t:ST_GUID" use="required"/>
      <xs:attributeGroup ref="desktop2:DesktopFtaHandlerAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="desktop2:DesktopPropertyHandler">
    <xs:complexType>
      <xs:attribute name="Clsid" type="t:ST_GUID" use="required"/>
      <xs:attributeGroup ref="desktop2:DesktopFtaHandlerAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:attributeGroup name="desktop2:DesktopFtaHandlerAttributes">
    <xs:attribute name="ManualSafeSave" type="xs:boolean" use="optional"/>
    <xs:attribute name="EnableShareDenyNone" type="xs:boolean" use="optional"/>
    <xs:attribute name="EnableShareDenyWrite" type="xs:boolean" use="optional"/>
    <xs:attribute name="NoOplock" type="xs:boolean" use="optional"/>
  </xs:attributeGroup>

  <xs:complexType name="desktop2:CT_FirewallRules">
    <xs:sequence>
      <xs:element name="desktop2:Rule" minOccurs="0" maxOccurs="1000">
        <xs:complexType>
          <xs:attribute name="Direction" type="desktop2:ST_FirewallRuleDirection" use="required"/>
          <xs:attribute name="IPProtocol" type="desktop2:ST_FirewallRuleIPProtocol" use="required"/>
          <xs:attribute name="Profile" type="desktop2:ST_FirewallRuleProfile" use="required"/>
          <xs:attribute name="LocalPortMin" type="desktop2:ST_FirewallRulePort" use="optional"/>
          <xs:attribute name="LocalPortMax" type="desktop2:ST_FirewallRulePort" use="optional"/>
          <xs:attribute name="RemotePortMin" type="desktop2:ST_FirewallRulePort" use="optional"/>
          <xs:attribute name="RemotePortMax" type="desktop2:ST_FirewallRulePort" use="optional"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="Executable" type="t:ST_ExecutableAnyCase" use="required"/>
  </xs:complexType>

  <xs:simpleType name="desktop2:ST_FirewallRuleDirection">
    <xs:restriction base="xs:string">
      <xs:enumeration value="in"/>
      <xs:enumeration value="out"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="desktop2:ST_FirewallRuleIPProtocol">
    <xs:restriction base="xs:string">
      <xs:enumeration value="ICMPv4"/>
      <xs:enumeration value="ICMPv6"/>
      <xs:enumeration value="TCP"/>
      <xs:enumeration value="UDP"/>
      <xs:enumeration value="GRE"/>
      <xs:enumeration value="AH"/>
      <xs:enumeration value="ESP"/>
      <xs:enumeration value="EGP"/>
      <xs:enumeration value="GGP"/>
      <xs:enumeration value="HMP"/>
      <xs:enumeration value="IGMP"/>
      <xs:enumeration value="RVD"/>
      <xs:enumeration value="OSPFIGP"/>
      <xs:enumeration value="PUP"/>
      <xs:enumeration value="RDP"/>
      <xs:enumeration value="RSVP"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="desktop2:ST_FirewallRuleProfile">
    <xs:restriction base="xs:string">
      <xs:enumeration value="domain"/>
      <xs:enumeration value="private"/>
      <xs:enumeration value="domainAndPrivate"/>
      <xs:enumeration value="public"/>
      <xs:enumeration value="all"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="desktop2:ST_FirewallRulePort">
    <xs:restriction base="xs:integer">
      <xs:minInclusive value="1"/>
      <xs:maxInclusive value="65535"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:element name="desktop2:OleClass">
    <xs:complexType>
      <xs:attribute name="Clsid" type="t:ST_GUID" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="desktop2:CT_DesktopEventLogging">
    <xs:all>
      <xs:element name="desktop2:EventMessageFiles">
        <xs:complexType>
          <xs:sequence maxOccurs="1000">
            <xs:element name="desktop2:File">
              <xs:complexType>
                <xs:attribute name="Path" type="t:ST_FileName" use="required"/>
              </xs:complexType>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element name="desktop2:TypesSupported">
        <xs:complexType>
          <xs:sequence maxOccurs="5">
            <xs:element name="desktop2:TypeSupported">
              <xs:complexType>
                <xs:attribute name="Value" type="desktop2:ST_DesktopEventLoggingType" use="required"/>
              </xs:complexType>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
        <xs:unique name="TypeSupported_Value">
          <xs:selector xpath="desktop2:TypeSupported"/>
          <xs:field xpath="@Value"/>
        </xs:unique>
      </xs:element>
    </xs:all>
    <xs:attribute name="AppName" type="t:ST_NonEmptyString" use="required"/>
  </xs:complexType>

  <xs:simpleType name="desktop2:ST_DesktopEventLoggingType">
    <xs:restriction base="xs:string">
      <xs:enumeration value="EVENTLOG_AUDIT_FAILURE"/>
      <xs:enumeration value="EVENTLOG_AUDIT_SUCCESS"/>
      <xs:enumeration value="EVENTLOG_ERROR_TYPE"/>
      <xs:enumeration value="EVENTLOG_INFORMATION_TYPE"/>
      <xs:enumeration value="EVENTLOG_WARNING_TYPE"/>
    </xs:restriction>
  </xs:simpleType>

  <!-- DesktopManifestSchema_v3.xsd -->
  <xs:element name="desktop3:Extension" substitutionGroup="f:ApplicationExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="desktop3:CloudFiles" type="desktop3:CT_CloudFiles"/>
        <xs:element name="desktop3:AutoPlayHandler" type="desktop3:CT_AutoPlayHandler"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ApplicationExtensionCategory_Desktop3" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="desktop3:CT_CloudFiles">
    <xs:all minOccurs="0">
      <xs:element name="desktop3:CustomStateHandler" type="desktop3:CT_CloudFilesHandler" />
      <xs:element name="desktop3:ThumbnailProviderHandler" type="desktop3:CT_CloudFilesHandler" />
      <xs:element name="desktop3:ExtendedPropertyHandler" type="desktop3:CT_CloudFilesHandler" />
      <xs:element name="desktop3:BannersHandler" type="desktop3:CT_CloudFilesHandler" />
      <xs:element ref="desktop4:ContentUriSource" minOccurs="0"/>
      <xs:element name="desktop3:CloudFilesContextMenus" type="desktop3:CT_CloudFilesContextMenus" />
      <xs:element ref="desktop4:DesktopIconOverlayHandlers" minOccurs="0"/>
    </xs:all>
    <xs:attribute name="IconResource" type="t:ST_ImageFile"/>
  </xs:complexType>

  <xs:complexType name="desktop3:CT_CloudFilesHandler">
    <xs:attribute name="Clsid" type="t:ST_GUID"/>
  </xs:complexType>

  <xs:complexType name="desktop3:CT_CloudFilesContextMenus">
    <xs:sequence minOccurs="0">
      <xs:element name="desktop3:Verb" maxOccurs="10000">
        <xs:complexType>
          <xs:attribute name="Id" type="desktop3:ST_CloudFilesContextMenusVerbId" use="required" />
          <xs:attribute name="Clsid" type="t:ST_GUID"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:simpleType name="desktop3:ST_CloudFilesContextMenusVerbId">
    <xs:restriction base="t:ST_NonEmptyString">
      <xs:minLength value="3"/>
      <xs:maxLength value="64"/>
      <xs:pattern value="([A-Za-z0-9]*)"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:complexType name="desktop3:CT_AutoPlayHandler">
    <xs:sequence minOccurs="0" maxOccurs="1000">
      <xs:element name="desktop3:InvokeAction">
        <xs:complexType>
          <xs:choice minOccurs="0" maxOccurs="1000">
            <xs:element name="desktop3:Content" type="desktop3:CT_Content"/>
            <xs:element name="desktop3:Device" type="desktop3:CT_Device"/>
          </xs:choice>
          <xs:attribute name="ActionDisplayName" type="t:ST_DisplayName" use="required"/>
          <xs:attribute name="ProviderDisplayName" type="t:ST_DisplayName" use="required"/>
          <xs:attribute name="DefaultIcon" type="t:ST_FileName"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="desktop3:CT_Content">
    <xs:attribute name="ContentEvent" type="t:ST_AutoPlayEvent" use="required"/>
    <xs:attribute name="Verb" type="t:ST_AutoPlayVerb" use="required"/>
    <xs:attribute name="DropTargetHandler" type="t:ST_GUID"/>
    <xs:attribute name="Parameters" type="t:ST_NonEmptyString"/>
  </xs:complexType>

  <xs:complexType name="desktop3:CT_Device">
    <xs:attribute name="DeviceEvent" type="t:ST_AutoPlayEvent" use="required"/>
    <xs:attribute name="HWEventHandler" type="t:ST_GUID" use="required"/>
    <xs:attribute name="InitCmdLine" type="t:ST_NonEmptyString"/>
  </xs:complexType>

  <xs:element name="desktop3:PropertyLists">
    <xs:complexType>
      <xs:sequence minOccurs="0" maxOccurs="2">
        <xs:element name="desktop3:PropertyList">
          <xs:complexType>
            <xs:attribute name="Property" type="desktop3:ST_Property" use="required"/>
            <xs:attribute name="Value" type="t:ST_NonEmptyString" use="required"/>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
    <xs:unique name="PropertyList_Property">
      <xs:selector xpath="desktop3:PropertyList"/>
      <xs:field xpath="@Property"/>
    </xs:unique>
  </xs:element>

  <xs:simpleType name="desktop3:ST_Property">
    <xs:restriction base="xs:string">
      <xs:enumeration value="fullDetails"/>
      <xs:enumeration value="previewDetails"/>
    </xs:restriction>
  </xs:simpleType>

  <!--DesktopManifestSchema_v4.xsd -->
  <xs:element name="desktop4:Extension" substitutionGroup="f:ApplicationExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="desktop4:FileExplorerContextMenus" type="desktop4:CT_FileExplorerContextMenus"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ApplicationExtensionCategory_Desktop4" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="desktop4:CT_FileExplorerContextMenus">
    <xs:sequence minOccurs="0" maxOccurs="10000">
      <xs:element name="desktop4:ItemType" type="desktop4:CT_ItemType" minOccurs="0"/>
      <xs:element ref="desktop5:ItemType" minOccurs="0"/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="desktop4:CT_ItemType">
    <xs:sequence minOccurs="0">
      <xs:element name="desktop4:Verb" maxOccurs="10000">
        <xs:complexType>
          <xs:attribute name="Id" type="t:ST_FileTypeAssociationSupportedVerbId" use="required" />
          <xs:attribute name="Clsid" type="t:ST_GUID" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="Type" type="t:ST_FileTypeOrStar" use="required"/>
  </xs:complexType>

  <xs:element name="desktop4:DesktopIconOverlayHandlers">
    <xs:complexType >
      <xs:sequence minOccurs="0">
        <xs:element name="desktop4:DesktopIconOverlayHandler" maxOccurs="10000">
          <xs:complexType>
            <xs:attribute name="Clsid" type="t:ST_GUID" use="required"/>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>

  <xs:element name="desktop4:ContentUriSource">
    <xs:complexType>
      <xs:attribute name="Clsid" type="t:ST_GUID" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:attribute name="desktop4:Subsystem" type="t:ST_Subsystem"/>
  <xs:attribute name="desktop4:SupportsMultipleInstances" type="xs:boolean"/>

  <!-- DesktopManifestSchema_v5.xsd -->
  <xs:attribute name="desktop5:ThumbnailTypeOverlay" type="t:ST_ImageFile"/>

  <xs:element name="desktop5:ItemType">
    <xs:complexType>
      <xs:sequence minOccurs="0">
        <xs:element name="desktop5:Verb" maxOccurs="10000">
          <xs:complexType>
            <xs:attribute name="Id" type="t:ST_FileTypeAssociationSupportedVerbId" use="required" />
            <xs:attribute name="Clsid" type="t:ST_GUID" use="required"/>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
      <xs:attribute name="Type" type="desktop5:ST_FileTypeOrStarWithDirectory" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:simpleType name="desktop5:ST_FileTypeOrStarWithDirectory">
    <xs:restriction base="t:ST_NonEmptyString">
      <xs:pattern value="(\*|(\.[^.\\]+))"/>
      <xs:pattern value="Directory"/>
      <xs:pattern value="Directory\\Background"/>
      <xs:maxLength value="64"/>
    </xs:restriction>
  </xs:simpleType>

  <!-- DesktopManifestSchema_v6.xsd -->
  <xs:element name="desktop6:Extension" substitutionGroup="f:ExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="desktop6:Service" type="desktop6:CT_Service"/>
        <xs:element name="desktop6:MutablePackageDirectories" type="desktop6:CT_MutablePackageDirectories"/>
        <xs:element name="desktop6:CustomInstall" type="desktop6:CT_CustomInstall"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ExtensionCategory_Desktop6" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="desktop6:CT_Service">
    <xs:all minOccurs="0">
      <xs:element name="desktop6:Dependencies" type="desktop6:CT_Dependencies" minOccurs="0"/>
      <xs:element name="desktop6:TriggerEvents" type="desktop6:CT_TriggerEvents" minOccurs="0"/>
    </xs:all>
    <xs:attribute name="Name" type="t:ST_NonEmptyString" use="required"/>
    <xs:attribute name="StartupType" type="desktop6:ST_StartupType" use="required"/>
    <xs:attribute name="StartAccount" type="desktop6:ST_StartAccount" use="required"/>
    <xs:attribute name="Arguments" type="t:ST_NonEmptyString"/>
  </xs:complexType>

  <xs:complexType name="desktop6:CT_Dependencies">
    <xs:sequence minOccurs="0" maxOccurs="10000">
      <xs:element name="desktop6:DependentService" type="desktop6:CT_DependentService"/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="desktop6:CT_DependentService">
    <xs:attribute name="Name" type="t:ST_NonEmptyString" use="required"/>
  </xs:complexType>

  <xs:simpleType name="desktop6:ST_StartAccount">
    <xs:restriction base="xs:string">
      <xs:enumeration value="localSystem"/>
      <xs:enumeration value="localService"/>
      <xs:enumeration value="networkService"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="desktop6:ST_StartupType">
    <xs:restriction base="xs:string">
      <xs:enumeration value="auto"/>
      <xs:enumeration value="manual"/>
      <xs:enumeration value="disabled"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:complexType name="desktop6:CT_TriggerEvents">
    <xs:sequence minOccurs="0" maxOccurs="10000">
      <xs:element name="desktop6:TriggerCustom" minOccurs="0" maxOccurs="10000">
        <xs:complexType>
          <xs:choice minOccurs="1" maxOccurs="10000">
            <xs:element name="desktop6:StringData" type="desktop6:CT_StringData"/>
            <xs:element name="desktop6:BinaryData" type="desktop6:CT_BinaryData"/>
            <xs:element name="desktop6:LevelData" type="desktop6:CT_ValueByte"/>
            <xs:element name="desktop6:KeywordAnyData" type="desktop6:CT_ValueDword64"/>
            <xs:element name="desktop6:KeywordAllData" type="desktop6:CT_ValueDword64"/>
          </xs:choice>
          <xs:attribute name="Action" type="desktop6:ST_ActionTrigger" use="required"/>
          <xs:attribute name="Subtype" type="t:ST_GUID" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="desktop6:CT_StringData">
    <xs:sequence minOccurs="1" maxOccurs="10000">
      <xs:element name="desktop6:DataItem">
        <xs:complexType>
          <xs:attribute name="Value" type="t:ST_NonEmptyString" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="desktop6:CT_BinaryData">
    <xs:attribute name="File" type="t:ST_FileName" use="required"/>
  </xs:complexType>

  <xs:complexType name="desktop6:CT_ValueByte">
   <xs:attribute name="Value" type="xs:unsignedByte" use="required"/>
  </xs:complexType>

  <xs:complexType name="desktop6:CT_ValueDword64">
   <xs:attribute name="Value" type="xs:unsignedLong" use="required"/>
  </xs:complexType>

  <xs:simpleType name="desktop6:ST_ActionTrigger">
    <xs:restriction base="xs:string">
      <xs:enumeration value="ActionStart"/>
      <xs:enumeration value="ActionStop"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:complexType name="desktop6:CT_MutablePackageDirectories">
    <xs:sequence minOccurs="1">
      <xs:element name="desktop6:MutablePackageDirectory" maxOccurs="1" >
        <xs:complexType>
            <xs:attribute name="Target" type="t:ST_FileNameSegment" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:element name="desktop6:RegistryWriteVirtualization" type="desktop6:ST_VirtualizationState" />
  <xs:element name="desktop6:FileSystemWriteVirtualization" type="desktop6:ST_VirtualizationState" />

  <xs:simpleType name="desktop6:ST_VirtualizationState">
    <xs:restriction base="xs:string">
      <xs:enumeration value="enabled"/>
      <xs:enumeration value="disabled"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:complexType name="desktop6:CT_CustomInstall">
    <xs:all>

      <xs:element name="desktop6:InstallActions" minOccurs="0" maxOccurs="1" >
        <xs:complexType>
          <xs:sequence minOccurs="0" maxOccurs="100">
            <xs:element name="desktop6:InstallAction" minOccurs="0" type="desktop6:CT_CustomInstallAction" />
          </xs:sequence>
        </xs:complexType>
      </xs:element>

      <xs:element name="desktop6:RepairActions" minOccurs="0" maxOccurs="1" >
        <xs:complexType>
          <xs:sequence minOccurs="0" maxOccurs="100">
            <xs:element name="desktop6:RepairAction" minOccurs="0" type="desktop6:CT_CustomInstallAction" />
          </xs:sequence>
        </xs:complexType>
      </xs:element>

      <xs:element name="desktop6:UninstallActions" minOccurs="0" maxOccurs="1" >
        <xs:complexType>
          <xs:sequence minOccurs="0" maxOccurs="100">
            <xs:element name="desktop6:UninstallAction" minOccurs="0" type="desktop6:CT_CustomInstallAction" />
          </xs:sequence>
        </xs:complexType>
      </xs:element>

    </xs:all>
    <xs:attribute name="Folder" type="t:ST_FileName" use="required" />
  </xs:complexType>

   <xs:complexType name="desktop6:CT_CustomInstallAction">
     <xs:attribute name="File" type="t:ST_FileName" use="required"/>
     <xs:attribute name="Name" type="t:ST_NonEmptyString" use="required"/>
     <xs:attribute name="Arguments" type="t:ST_NonEmptyString" />
   </xs:complexType>

  <!-- RestrictedCapabilitiesManifestSchema.xsd -->
  <xs:element name="rescap:Capability" substitutionGroup="f:CapabilityChoice">
    <xs:complexType>
      <xs:attribute name="Name" type="t:ST_Capability_Windows_Restricted_Party" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="rescap:Extension" substitutionGroup="f:ApplicationExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="rescap:SettingsApp" type="CT_SettingsApp"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ApplicationExtensionCategory_Restricted" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="rescap:CT_SettingsApp">
    <xs:sequence>
      <xs:element name="rescap:AppLinks" type="CT_SettingsExtensionAppLinkCollection" minOccurs="0" maxOccurs="1"/>
      <xs:element name="rescap:SearchTerms" type="CT_SettingsExtensionAppSearchTermsCollection" minOccurs="0" maxOccurs="1"/>
    </xs:sequence>
    <xs:attribute name="SettingsPageUri" type="t:ST_SettingsPageUri" use="optional"/>
    <xs:attribute name="Category" type="t:ST_SettingsAppCategories" use="optional"/>
  </xs:complexType>

  <xs:complexType name="rescap:CT_SettingsExtensionAppLinkCollection">
    <xs:sequence>
      <xs:element name="rescap:Link" type="CT_SettingsExtensionAppLink" minOccurs="1" maxOccurs="5" />
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="rescap:CT_SettingsExtensionAppLink">
    <xs:attribute name="AppActivationMode" type="xs:string"/>
    <xs:attribute name="DisplayName" type="xs:string"/>
  </xs:complexType>

  <xs:complexType name="rescap:CT_SettingsExtensionAppSearchTermsCollection">
    <xs:sequence>
      <xs:element name="rescap:Term" type="xs:string" minOccurs="0" maxOccurs="5" />
    </xs:sequence>
  </xs:complexType>

  <!-- RestrictedCapabilitiesManifestSchema_v3.xsd -->
  <xs:element name="rescap3:Extension" substitutionGroup="f:ApplicationExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="rescap3:DesktopAppMigration" type="CT_DesktopAppMigration"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ApplicationExtensionCategory_Restricted3" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="rescap3:MigrationProgIds">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="rescap3:MigrationProgId" minOccurs="0" maxOccurs="10000" type="t:ST_ProgId" />
      </xs:sequence>
    </xs:complexType>
    <xs:unique name="MigrationProgId_ProgId">
      <xs:selector xpath="rescap3:MigrationProgId"/>
      <xs:field xpath="."/>
    </xs:unique>
  </xs:element>

  <xs:attributeGroup name="rescap3:DdeExecAttributes">
    <xs:attribute name="DdeExecCommand" type="t:ST_NonEmptyString" form="qualified" use="optional"/>
    <xs:attribute name="DdeExecApplication" type="t:ST_NonEmptyString" form="qualified" use="optional"/>
    <xs:attribute name="DdeExecTopic" type="t:ST_NonEmptyString" form="qualified" use="optional"/>
    <xs:attribute name="DdeExecIfExec" type="t:ST_NonEmptyString" form="qualified" use="optional"/>
  </xs:attributeGroup>

  <xs:complexType name="rescap3:CT_DesktopAppMigration">
    <xs:sequence>
      <xs:element name="rescap3:DesktopApp" minOccurs="0" maxOccurs="10000">
        <xs:complexType>
          <xs:attribute name="AumId" type="t:ST_NonEmptyString"/>
          <xs:attribute name="ShortcutPath" type="t:ST_NonEmptyString"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="AcquisitionUri" type="t:ST_URI" use="optional"/>
  </xs:complexType>

  <!-- ComManifestSchema.xsd -->
  <xs:element name="com:Extensions" substitutionGroup="f:ComExtensions" type="com:CT_ComPackageExtensions"/>

  <xs:complexType name="com:CT_ComPackageExtensions">
    <xs:choice minOccurs ="0" maxOccurs="10000">
      <xs:element name="com:Extension">
        <xs:complexType>
          <xs:choice>
            <xs:element name="com:ComInterface" maxOccurs="1" type="com:CT_ComInterface"/>
          </xs:choice>
          <xs:attribute name="Category" type="t:ST_PackageExtensionCategory_Com" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:choice>
  </xs:complexType>

  <xs:element name="com:Extension" substitutionGroup="f:ExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="com:ComServer" type="com:CT_ComServer" maxOccurs="1">
          <!-- Class/@AutoConvertTo, ProgId/@Clsid and TreatAsClass/@TreatAs refers to ExeServer/Class/@Id | SurrogateServer/Class/@Id | TreatAsClass/@Id-->
          <xs:key name="Class_Or_TreatAsClass_IdKey">
            <xs:selector xpath="com:ExeServer/com:Class | com:SurrogateServer/com:Class | com:TreatAsClass"/>
            <xs:field xpath="@Id"/>
          </xs:key>
          <xs:keyref name="ProgId_ClsidRef" refer="Class_Or_TreatAsClass_IdKey">
            <xs:selector xpath="com:ProgId"/>
            <xs:field xpath="@Clsid"/>
          </xs:keyref>
          <xs:keyref name="TreatAsRef" refer="Class_Or_TreatAsClass_IdKey">
            <xs:selector xpath="com:TreatAsClass"/>
            <xs:field xpath="@TreatAs"/>
          </xs:keyref>
          <xs:keyref name="AutoConvertToRef" refer="Class_Or_TreatAsClass_IdKey">
            <xs:selector xpath="com:ExeServer/com:Class | com:SurrogateServer/com:Class | com:TreatAsClass"/>
            <xs:field xpath="@AutoConvertTo"/>
          </xs:keyref>
          <!-- Class/@ProgId , Class/@VersionIndependentProgId and ProgId/@CurrentVersion refer to ProgId/@Id-->
          <xs:key name="ProgId_IdKey">
            <xs:selector xpath="com:ProgId"/>
            <xs:field xpath="@Id"/>
          </xs:key>
          <xs:keyref name="Class_ProgIdRef" refer="ProgId_IdKey">
            <xs:selector xpath="com:ExeServer/com:Class | com:SurrogateServer/com:Class"/>
            <xs:field xpath="@ProgId"/>
          </xs:keyref>
          <xs:keyref name="Class_VerIndProgIdRef" refer="ProgId_IdKey">
            <xs:selector xpath="com:ExeServer/com:Class | com:SurrogateServer/com:Class"/>
            <xs:field xpath="@VersionIndependentProgId"/>
          </xs:keyref>
          <xs:keyref name="ProgId_CurrentVersionRef" refer="ProgId_IdKey">
            <xs:selector xpath="com:ProgId"/>
            <xs:field xpath="@CurrentVersion"/>
          </xs:keyref>
        </xs:element>
        <xs:element name="com:ComInterface" type="com:CT_ComInterface" maxOccurs="1">
          <xs:key name="Interface_IdKey">
            <xs:selector xpath="com:Interface"/>
            <xs:field xpath="@Id"/>
          </xs:key>
          <xs:keyref name="SynchronousRef" refer="Interface_IdKey">
            <xs:selector xpath="com:Interface"/>
            <xs:field xpath="@SynchronousInterface"/>
          </xs:keyref>
          <xs:keyref name="AsynchronousRef" refer="Interface_IdKey">
            <xs:selector xpath="com:Interface"/>
            <xs:field xpath="@AsynchronousInterface"/>
          </xs:keyref>
          <!--Interface\@ProxyStubClsid refers to ProxyStub/@Id-->
          <xs:key name="ProxyStub_IdKey">
            <xs:selector xpath="com:ProxyStub"/>
            <xs:field xpath="@Id"/>
          </xs:key>
          <xs:keyref name="Interface_ProxyStubClsidRef" refer="ProxyStub_IdKey">
            <xs:selector xpath="com:Interface"/>
            <xs:field xpath="@ProxyStubClsid"/>
          </xs:keyref>
          <!--Interface/TypeLib/@Id refers to TypeLib/@Id-->
          <xs:key name="TypeLib_IdKey">
            <xs:selector xpath="com:TypeLib"/>
            <xs:field xpath="@Id"/>
          </xs:key>
          <xs:keyref name="TypeLib_IdRef" refer="TypeLib_IdKey">
            <xs:selector xpath="com:Interface/com:TypeLib"/>
            <xs:field xpath="@Id"/>
          </xs:keyref>
        </xs:element>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ExtensionCategory_Com" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="com:CT_ComServer">
    <xs:sequence>
      <xs:element ref="com:ExeServer" minOccurs="0" maxOccurs="1000"/>
      <xs:element ref="com:SurrogateServer" minOccurs="0" maxOccurs="1000"/>
      <xs:element ref="com:TreatAsClass" minOccurs="0" maxOccurs="10000"/>
      <xs:element ref="com:ProgId" minOccurs="0" maxOccurs="10000"/>
    </xs:sequence>
  </xs:complexType>

  <xs:element name="com:ExeServer" type="com:T_ExeServer" />
  <xs:element name="com:SurrogateServer" type="com:CT_SurrogateServer" />
  <xs:element name="com:TreatAsClass" type="com:CT_TreatAsClass" />
  <xs:element name="com:ProgId" type="com:CT_ProgId" />

  <xs:complexType name="com:CT_ComInterface">
    <xs:sequence>
      <xs:element ref="com:ProxyStub" minOccurs="0" maxOccurs="1000"/>
      <xs:element ref="com:Interface" minOccurs="0" maxOccurs="10000"/>
      <xs:element ref="com:TypeLib" minOccurs="0" maxOccurs="1000"/>
    </xs:sequence>
  </xs:complexType>

  <xs:element name="com:ProxyStub" type="com:CT_ProxyStub">
    <xs:unique name="ProxyStubDll_ProcessorArchitecture">
      <xs:selector xpath="com2:ProxyStubDll"/>
      <xs:field xpath="@ProcessorArchitecture"/>
    </xs:unique>
    <xs:unique name="ProxyStubDll_Path">
      <xs:selector xpath="com2:ProxyStubDll"/>
      <xs:field xpath="@Path"/>
    </xs:unique>
  </xs:element>
  <xs:element name="com:Interface" type="com:CT_Interface"/>
  <xs:element name="com:TypeLib" type="com:CT_TypeLib">
    <xs:unique name="Version_VersionNumber">
      <xs:selector xpath="com:Version"/>
      <xs:field xpath="@VersionNumber"/>
    </xs:unique>
  </xs:element>

  <xs:complexType name="com:CT_ExeServer">
    <xs:sequence>
      <xs:element name="com:Class" type="com:CT_ExeServerClass" minOccurs="1" maxOccurs="10000"/>
    </xs:sequence>
    <xs:attribute name="Executable" type="t:ST_ExecutableAnyCase" use="required"/>
    <xs:attribute name="Arguments" type="t:ST_NonEmptyString"/>
    <xs:attribute name="DisplayName" type="t:ST_DisplayName"/>
    <xs:attribute name="LaunchAndActivationPermission" type="com:ST_Permissions" />
  </xs:complexType>

  <xs:complexType name="com:CT_Class">
    <xs:attribute name="Id" type="t:ST_GUID" use="required"/>
    <xs:attribute name="DisplayName" type="t:ST_DisplayName"/>
  </xs:complexType>

  <xs:complexType name="com:CT_OutOfProcClass">
    <xs:complexContent>
      <xs:extension base="com:CT_Class">
        <xs:all>
          <xs:element name="com:ImplementedCategories" type="com:CT_ImplementedCategories" minOccurs="0">
            <xs:unique name="ImplementedCategory_Id">
              <xs:selector xpath="com:ImplementedCategory"/>
              <xs:field xpath="@Id"/>
            </xs:unique>
          </xs:element>
          <xs:element name="com:Conversion" type="com:CT_Conversion" minOccurs="0"/>
          <xs:element name="com:DataFormats" type="com:CT_DataFormats" minOccurs="0">
            <xs:unique name="DataFormats_All">
              <xs:selector xpath="com:DataFormat"/>
              <xs:field xpath="@FormatName"/>
              <xs:field xpath="@StandardFormat"/>
              <xs:field xpath="@AspectFlag"/>
              <xs:field xpath="@MediumFlag"/>
              <xs:field xpath="@Direction"/>
            </xs:unique>
          </xs:element>
          <xs:element name="com:MiscStatus" type="com:CT_MiscStatus" minOccurs="0">
            <xs:unique name="Aspect_Type">
              <xs:selector xpath="com:Aspect"/>
              <xs:field xpath="@Type"/>
            </xs:unique>
          </xs:element>
          <xs:element name="com:Verbs" type="com:CT_Verbs" minOccurs="0">
            <xs:unique name="Verb_Index">
              <xs:selector xpath="com:Verb"/>
              <xs:field xpath="@Id"/>
            </xs:unique>
          </xs:element>
          <xs:element name="com:DefaultIcon" type="com:CT_DefaultIcon" minOccurs="0"/>
          <xs:element name="com:ToolboxBitmap32" type="com:CT_ToolboxBitmap" minOccurs="0"/>
        </xs:all>
        <xs:attribute name="com:EnableOleDefaultHandler" type="xs:boolean"/>
        <xs:attribute name="com:ProgId" type="t:ST_ProgId"/>
        <xs:attribute name="com:VersionIndependentProgId" type="t:ST_ProgId"/>
        <xs:attribute name="com:AutoConvertTo" type="t:ST_GUID"/>
        <xs:attribute name="com:InsertableObject" type="xs:boolean"/>
        <xs:attribute name="com:ShortDisplayName" type="t:ST_ShortDisplayName"/>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:complexType name="com:CT_ExeServerClass">
    <xs:complexContent>
      <xs:extension base="com:CT_OutOfProcClass"/>
    </xs:complexContent>
  </xs:complexType>

  <xs:complexType name="com:CT_ImplementedCategories">
    <xs:sequence>
      <xs:element name="com:ImplementedCategory" type="com:CT_ImplementedCategory" minOccurs="1" maxOccurs="1000"/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="com:CT_ImplementedCategory">
    <xs:attribute name="Id" type="t:ST_GUID" use="required"/>
  </xs:complexType>

  <xs:complexType name="com:CT_Conversion">
    <xs:all minOccurs="0">
      <xs:element name="com:Readable" type="com:CT_ConversionFormats" minOccurs="0">
        <xs:unique name="Readable_Format_FormatName">
          <xs:selector xpath="com:Format"/>
          <xs:field xpath="@FormatName"/>
        </xs:unique>
        <xs:unique name="Readable_Format_StandardFormat">
          <xs:selector xpath="com:Format"/>
          <xs:field xpath="@StandardFormat"/>
        </xs:unique>
      </xs:element>
      <xs:element name="com:ReadWritable" type="com:CT_ConversionFormats" minOccurs="0">
        <xs:unique name="ReadWritable_Format_FormatName">
          <xs:selector xpath="com:Format"/>
          <xs:field xpath="@FormatName"/>
        </xs:unique>
        <xs:unique name="ReadWritable_Format_StandardFormat">
          <xs:selector xpath="com:Format"/>
          <xs:field xpath="@StandardFormat"/>
        </xs:unique>
      </xs:element>
    </xs:all>
  </xs:complexType>

  <xs:complexType name="com:CT_ConversionFormats">
    <xs:sequence>
      <xs:element name="com:Format" type="com:CT_ConversionFormat" minOccurs="1" maxOccurs="1000"/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="com:CT_ConversionFormat">
    <xs:attribute name="FormatName" type="t:ST_NonEmptyString"/>
    <xs:attribute name="StandardFormat" type="com:ST_Hexadecimal"/>
  </xs:complexType>

  <xs:complexType name="com:CT_DataFormats">
    <xs:sequence>
      <xs:element name="com:DataFormat" type="com:CT_DataFormat" minOccurs="0" maxOccurs="1000"/>
    </xs:sequence>
    <xs:attribute name="DefaultFormatName" type="t:ST_NonEmptyString"/>
    <xs:attribute name="DefaultStandardFormat" type="com:ST_Hexadecimal"/>
  </xs:complexType>

  <xs:complexType name="com:CT_DataFormat">
    <xs:attribute name="FormatName" type="t:ST_NonEmptyString"/>
    <xs:attribute name="StandardFormat" type="com:ST_Hexadecimal"/>
    <xs:attribute name="AspectFlag" type="com:ST_Aspect" use="required"/>
    <xs:attribute name="MediumFlag" type="com:ST_Medium" use="required"/>
    <xs:attribute name="Direction" type="com:ST_DataFormatDirection" use="required"/>
  </xs:complexType>

  <xs:complexType name="com:CT_MiscStatus">
    <xs:sequence>
      <xs:element name="com:Aspect" type="com:CT_Aspect" minOccurs="0" maxOccurs="1000"/>
    </xs:sequence>
    <xs:attribute name="OleMiscFlag" type="com:ST_OleMisc" use="required"/>
  </xs:complexType>

  <xs:complexType name="com:CT_Aspect">
    <xs:attribute name="Type" type="com:ST_AspectType" use="required"/>
    <xs:attribute name="OleMiscFlag" type="com:ST_OleMisc" use="required"/>
  </xs:complexType>

  <xs:complexType name="com:CT_Verbs">
    <xs:sequence>
      <xs:element name="Verb" type="com:CT_ComVerb" minOccurs="1" maxOccurs="1000"/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="com:CT_ComVerb">
    <xs:attribute name="Id" type="com:ST_VerbIndex" use="required"/>
    <xs:attribute name="DisplayName" type="t:ST_DisplayName" use="required"/>
    <xs:attribute name="AppendMenuFlag" type="com:ST_AppendMenu" use="required"/>
    <xs:attribute name="OleVerbFlag" type="com:ST_OleVerb" use="required"/>
  </xs:complexType>

  <xs:complexType name="com:CT_DefaultIcon">
    <xs:attribute name="Path" type="t:ST_FileName" use="required"/>
    <xs:attribute name="ResourceIndex" type="xs:int"/>
  </xs:complexType>

  <xs:complexType name="com:CT_ToolboxBitmap">
    <xs:attribute name="Path" type="t:ST_FileName" use="required"/>
    <xs:attribute name="ResourceId" type="xs:positiveInteger"/>
  </xs:complexType>

  <xs:complexType name="com:CT_SurrogateServer">
    <xs:sequence>
      <xs:element name="com:Class" type="com:CT_SurrogateClass" minOccurs="1" maxOccurs="10000"/>
    </xs:sequence>
    <xs:attribute name="CustomSurrogateExecutable" type="t:ST_ExecutableAnyCase"/>
    <xs:attribute name="DisplayName" type="t:ST_DisplayName" />
    <xs:attribute name="LaunchAndActivationPermission" type="com:ST_Permissions" />
    <xs:attribute name="AppId" type="t:ST_GUID" />
    <xs:attribute name="SystemSurrogate" type="com:ST_SystemSurrogate" />
  </xs:complexType>

  <xs:complexType name="com:CT_SurrogateClass">
    <xs:complexContent>
      <xs:extension base="com:CT_OutOfProcClass">
        <xs:attribute name="Path" type="t:ST_FileName" use="required"/>
        <xs:attribute name="ThreadingModel" type="com:ST_ThreadingModel" use="required"/>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:complexType name="com:CT_ProxyStub">
    <xs:complexContent>
      <xs:extension base="com:CT_Class">
        <xs:sequence>
          <xs:element ref="com2:ProxyStubDll" minOccurs="0" maxOccurs="4"/>
        </xs:sequence>
        <xs:attribute name="Path" type="t:ST_FileName" use="optional"/>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:complexType name="com:CT_Interface">
    <xs:all>
      <xs:element name="com:TypeLib" type="com:CT_TypeLibRef" minOccurs="0"/>
    </xs:all>
    <xs:attribute name="Id" type="t:ST_GUID" use="required"/>
    <xs:attribute name="UseUniversalMarshaler" type="xs:boolean"/>
    <xs:attribute name="ProxyStubClsid" type="t:ST_GUID"/>
    <xs:attribute name="SynchronousInterface" type="t:ST_GUID"/>
    <xs:attribute name="AsynchronousInterface" type="t:ST_GUID"/>
  </xs:complexType>

  <xs:complexType name="com:CT_TypeLibRef">
    <xs:attribute name="Id" type="t:ST_GUID" use="required"/>
    <xs:attribute name="VersionNumber" type="com:ST_Version"/>
  </xs:complexType>

  <xs:complexType name="com:CT_TypeLib">
    <xs:sequence>
      <xs:element name="com:Version" type="com:CT_TypeLibVersion" minOccurs="1" maxOccurs="1000"/>
    </xs:sequence>
    <xs:attribute name="Id" type="t:ST_GUID" use="required"/>
  </xs:complexType>

  <xs:complexType name="com:CT_TypeLibVersion">
    <xs:all minOccurs="0">
      <xs:element name="Win32Path" type="com:CT_TypeLibPath" minOccurs="0"/>
      <xs:element name="Win64Path" type="com:CT_TypeLibPath" minOccurs="0"/>
    </xs:all>
    <xs:attribute name="VersionNumber" type="com:ST_Version" use="required"/>
    <xs:attribute name="LocaleId" type="com:ST_Hexadecimal" default="0"/>
    <xs:attribute name="LibraryFlag" type="com:ST_LibFlag"/>
    <xs:attribute name="HelpDirectory" type="t:ST_NonEmptyString"/>
    <xs:attribute name="DisplayName" type="t:ST_DisplayName"/>
  </xs:complexType>

  <xs:complexType name="com:CT_TypeLibPath">
    <xs:attribute name="Path" type="t:ST_FileName" use="required"/>
    <xs:attribute name="ResourceId" type="xs:positiveInteger" use="optional"/>
  </xs:complexType>

  <xs:complexType name="com:CT_ProgId">
    <xs:attribute name="Id" type="t:ST_ProgId" use="required"/>
    <xs:attribute name="Clsid" type="t:ST_GUID"/>
    <xs:attribute name="CurrentVersion " type="t:ST_ProgId"/>
  </xs:complexType>

  <xs:complexType name="com:CT_TreatAsClass">
    <xs:complexContent>
      <xs:extension base="com:CT_Class">
        <xs:attribute name="TreatAs" type="t:ST_GUID" use="required"/>
        <xs:attribute name="AutoConvertTo" type="t:ST_GUID"/>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:simpleType name="com:ST_Version">
    <xs:restriction base="xs:string">
      <xs:pattern value="(0|[1-9a-fA-F][0-9a-fA-F]{0,3})\.(0|[1-9a-fA-F][0-9a-fA-F]{0,3})"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="com:ST_Permissions">
    <xs:restriction base="xs:string">
      <xs:pattern value="(O:[A-Z0-9\-]*)?(G:[A-Z0-9\-]*)?(D:[PARI]*(\([A-Z0-9\-;]*\))*)?(S:[PARI]*(\([A-Z0-9\-;]*\))*)?"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="com:ST_Hexadecimal">
    <xs:restriction base="xs:string">
      <xs:pattern value="[0-9a-fA-F]{1,4}"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="com:ST_ThreadingModel">
    <xs:restriction base="xs:string">
      <xs:enumeration value="Both"/>
      <xs:enumeration value="STA"/>
      <xs:enumeration value="MTA"/>
      <xs:enumeration value="MainSTA"/>
      <xs:enumeration value="Neutral"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="com:ST_AspectType">
    <xs:restriction base="xs:string">
      <xs:enumeration value="Content"/>
      <xs:enumeration value="Thumbnail"/>
      <xs:enumeration value="Icon"/>
      <xs:enumeration value="DocPrint"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="com:ST_DataFormatDirection">
    <xs:restriction base="xs:string">
      <xs:enumeration value="Get"/>
      <xs:enumeration value="Set"/>
      <xs:enumeration value="GetAndSet"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="com:ST_SystemSurrogate">
    <xs:restriction base="xs:string">
      <xs:enumeration value="PreviewHost"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="com:ST_VerbIndex">
    <xs:restriction base="xs:int">
      <xs:minInclusive value="-6"/>
      <xs:maxInclusive value="1000"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="com:ST_Aspect">
    <xs:restriction base="xs:int">
      <xs:minInclusive value="-1"/>
      <xs:maxInclusive value="15"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="com:ST_Medium">
    <xs:restriction base="xs:int">
      <xs:minInclusive value="0"/>
      <xs:maxInclusive value="127"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="com:ST_OleMisc">
    <xs:restriction base="xs:int">
      <xs:minInclusive value="0"/>
      <xs:maxInclusive value="4194303"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="com:ST_AppendMenu">
    <xs:restriction base="xs:int">
      <xs:minInclusive value="0"/>
      <xs:maxInclusive value="2431"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="com:ST_OleVerb">
    <xs:restriction base="xs:int">
      <xs:minInclusive value="0"/>
      <xs:maxInclusive value="3"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="com:ST_LibFlag">
    <xs:restriction base="xs:string">
      <xs:pattern value="[0-9a-fA-F]"/>
    </xs:restriction>
  </xs:simpleType>

<!-- ComManifestSchema_v2.xsd -->

  <xs:element name="com2:ProxyStubDll" type="CT_ProxyStubDll"/>

  <xs:complexType name="com2:CT_ProxyStubDll">
    <xs:attribute name="Path" type="t:ST_FileName" use="required"/>
    <xs:attribute name="ProcessorArchitecture" type="t:ST_ArchitectureNonNeutral" use="required"/>
  </xs:complexType>

  <xs:element name="com2:Extension" substitutionGroup="f:ExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="com2:ComServer" type="com2:CT_ComServer" maxOccurs="1">
          <!-- Class/@AutoConvertTo, ProgId/@Clsid and TreatAsClass/@TreatAs refers to ExeServer/Class/@Id | SurrogateServer/Class/@Id | TreatAsClass/@Id-->
          <xs:key name="Class_Or_TreatAsClass_IdKey">
            <xs:selector xpath="com:ExeServer/com:Class | com:SurrogateServer/com:Class | com:TreatAsClass"/>
            <xs:field xpath="@Id"/>
          </xs:key>
          <xs:keyref name="ProgId_ClsidRef" refer="Class_Or_TreatAsClass_IdKey">
            <xs:selector xpath="com:ProgId"/>
            <xs:field xpath="@Clsid"/>
          </xs:keyref>
          <xs:keyref name="TreatAsRef" refer="Class_Or_TreatAsClass_IdKey">
            <xs:selector xpath="com:TreatAsClass"/>
            <xs:field xpath="@TreatAs"/>
          </xs:keyref>
          <xs:keyref name="AutoConvertToRef" refer="Class_Or_TreatAsClass_IdKey">
            <xs:selector xpath="com:ExeServer/com:Class | com:SurrogateServer/com:Class | com:TreatAsClass"/>
            <xs:field xpath="@AutoConvertTo"/>
          </xs:keyref>
          <!-- Class/@ProgId , Class/@VersionIndependentProgId and ProgId/@CurrentVersion refer to ProgId/@Id-->
          <xs:key name="ProgId_IdKey">
            <xs:selector xpath="com:ProgId"/>
            <xs:field xpath="@Id"/>
          </xs:key>
          <xs:keyref name="Class_ProgIdRef" refer="ProgId_IdKey">
            <xs:selector xpath="com:ExeServer/com:Class | com:SurrogateServer/com:Class"/>
            <xs:field xpath="@ProgId"/>
          </xs:keyref>
          <xs:keyref name="Class_VerIndProgIdRef" refer="ProgId_IdKey">
            <xs:selector xpath="com:ExeServer/com:Class | com:SurrogateServer/com:Class"/>
            <xs:field xpath="@VersionIndependentProgId"/>
          </xs:keyref>
          <xs:keyref name="ProgId_CurrentVersionRef" refer="ProgId_IdKey">
            <xs:selector xpath="com:ProgId"/>
            <xs:field xpath="@CurrentVersion"/>
          </xs:keyref>
        </xs:element>
        <xs:element name="ComInterface" type="CT_ComInterface" maxOccurs="1">
          <xs:key name="Interface_IdKey">
            <xs:selector xpath="com:Interface"/>
            <xs:field xpath="@Id"/>
          </xs:key>
          <xs:keyref name="SynchronousRef" refer="Interface_IdKey">
            <xs:selector xpath="com:Interface"/>
            <xs:field xpath="@SynchronousInterface"/>
          </xs:keyref>
          <xs:keyref name="AsynchronousRef" refer="Interface_IdKey">
            <xs:selector xpath="com:Interface"/>
            <xs:field xpath="@AsynchronousInterface"/>
          </xs:keyref>
          <!--Interface\@ProxyStubClsid refers to ProxyStub/@Id-->
          <xs:key name="ProxyStub_IdKey">
            <xs:selector xpath="com:ProxyStub"/>
            <xs:field xpath="@Id"/>
          </xs:key>
          <xs:keyref name="Interface_ProxyStubClsidRef" refer="ProxyStub_IdKey">
            <xs:selector xpath="com:Interface"/>
            <xs:field xpath="@ProxyStubClsid"/>
          </xs:keyref>
          <!--Interface/TypeLib/@Id refers to TypeLib/@Id-->
          <xs:key name="TypeLib_IdKey">
            <xs:selector xpath="com:TypeLib"/>
            <xs:field xpath="@Id"/>
          </xs:key>
          <xs:keyref name="TypeLib_IdRef" refer="TypeLib_IdKey">
            <xs:selector xpath="com:Interface/com:TypeLib"/>
            <xs:field xpath="@Id"/>
          </xs:keyref>
        </xs:element>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ExtensionCategory_Com" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="com2:CT_ComServer">
    <xs:choice minOccurs="0" maxOccurs="4000">
      <xs:element ref="com:ExeServer"/>
      <xs:element ref="com:SurrogateServer"/>
      <xs:element ref="com:TreatAsClass"/>
      <xs:element ref="com:ProgId"/>
    </xs:choice>
  </xs:complexType>

  <xs:complexType name="com2:CT_ComInterface">
    <xs:choice minOccurs="0" maxOccurs="10000">
      <xs:element ref="com:ProxyStub"/>
      <xs:element ref="com:Interface"/>
      <xs:element ref="com:TypeLib"/>
    </xs:choice>
  </xs:complexType>

  <!-- UapManifestSchema.xsd -->
  <xs:attribute name="uap:Scale" type="t:ST_Scale_All"/>
  <xs:attribute name="uap:DXFeatureLevel" type="t:ST_DXFeatureLevel"/>

  <xs:element name="uap:SupportedUsers" type="t:ST_SupportedUsers"/>

  <xs:element name="uap:Capability" substitutionGroup="f:CapabilityChoice">
    <xs:complexType>
      <xs:attribute name="Name" type="t:ST_Capability_Uap" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="uap:VisualElements" type="uap:CT_VisualElements" substitutionGroup="f:VisualElementsChoice">
    <xs:unique name="InitialRotationPreference_Name">
      <xs:selector xpath="uap:InitialRotationPreference/uap:Rotation"/>
      <xs:field xpath="@Preference"/>
    </xs:unique>
  </xs:element>

  <xs:complexType name="uap:CT_VisualElements">
    <xs:all>
      <xs:element name="uap:DefaultTile" type="uap:CT_DefaultTile" minOccurs="0"/>
      <xs:element name="uap:LockScreen" type="t:CT_LockScreen" minOccurs="0"/>
      <xs:element name="uap:SplashScreen" type="uap:CT_SplashScreen" minOccurs="0"/>
      <xs:element name="uap:InitialRotationPreference" type="uap:CT_InitialRotationPreference" minOccurs="0"/>
    </xs:all>
    <xs:attribute name="DisplayName" type="t:ST_DisplayName" use="required"/>
    <xs:attribute name="Description" type="t:ST_Description" use="required"/>
    <xs:attribute name="BackgroundColor" type="t:ST_Color" use="required"/>
    <xs:attribute name="Square150x150Logo" type="t:ST_ImageFile" use="required"/>
    <xs:attribute name="Square44x44Logo" type="t:ST_ImageFile" use="required"/>
    <xs:attribute name="AppListEntry" type="t:ST_AppListEntry" use="optional"/>
  </xs:complexType>

  <xs:complexType name="uap:CT_DefaultTile">
    <xs:all>
      <xs:element name="uap:TileUpdate" type="t:CT_TileUpdate" minOccurs="0"/>
      <xs:element name="uap:ShowNameOnTiles" minOccurs="0">
        <xs:complexType>
          <xs:sequence>
            <xs:element name="uap:ShowOn" maxOccurs="4">
              <xs:complexType>
                <xs:attribute name="Tile" type="t:ST_ShowNameSize" use="required"/>
              </xs:complexType>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
        <xs:unique name="ShowOn_Tile">
          <xs:selector xpath="uap:ShowOn"/>
          <xs:field xpath="@Tile"/>
        </xs:unique>
      </xs:element>
      <xs:element ref="uap:HoloContentChoice" minOccurs="0"/>
      <xs:element ref="uap5:MixedRealityModel" minOccurs="0"/>
    </xs:all>
    <xs:attribute name="Wide310x150Logo" type="t:ST_ImageFile" use="optional"/>
    <xs:attribute name="Square310x310Logo" type="t:ST_ImageFile" use="optional"/>
    <xs:attribute name="Square71x71Logo" type="t:ST_ImageFile" use="optional"/>
    <xs:attribute name="ShortName" type="t:ST_ShortDisplayName" use="optional"/>
  </xs:complexType>

  <xs:complexType name="uap:CT_SplashScreen">
    <xs:complexContent>
      <xs:extension base="t:CT_SplashScreen">
        <xs:attributeGroup ref="uap5:SplashScreenAttributes"/>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="uap:HoloContentChoice" abstract="true"/>

  <xs:complexType name="uap:CT_InitialRotationPreference">
    <xs:sequence>
      <xs:element name="uap:Rotation" maxOccurs="4" type="t:CT_Rotation"/>
    </xs:sequence>
  </xs:complexType>

  <xs:element name="uap:ApplicationContentUriRules">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="uap:Rule" maxOccurs="100">
          <xs:complexType>
            <xs:attribute name="Type" type="t:ST_RuleType" use="required"/>
            <xs:attribute name="Match" type="t:ST_URI" use="required"/>
            <xs:attribute name="WindowsRuntimeAccess" type="t:ST_ApplicationContentUriRunTimeAccess_Uap" use="optional"/>
            <xs:attributeGroup ref="uap5:ContentUriRuleAttributes"/>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>

  <xs:element name="uap:Extension" substitutionGroup="f:ApplicationExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element ref="uap:FileTypeAssociationChoice"/>
        <xs:element ref="uap:ProtocolChoice"/>
        <xs:element ref="uap:AppServiceChoice"/>
        <xs:element name="uap:AutoPlayContent" type="uap:CT_AutoPlayContent"/>
        <xs:element name="uap:AutoPlayDevice" type="uap:CT_AutoPlayDevice"/>
        <xs:element name="uap:ShareTarget" type="uap:CT_ShareTarget"/>
        <xs:element name="uap:FileOpenPicker" type="uap:CT_FilePicker"/>
        <xs:element name="uap:FileSavePicker" type="uap:CT_FilePicker"/>
        <xs:element name="uap:AppointmentsProvider" type="uap:CT_AppointmentsProvider"/>
        <xs:element name="uap:WebAccountProvider" type="uap:CT_WebAccountProvider"/>
        <xs:element name="uap:DialProtocol" type="uap:CT_DialProtocol"/>
        <xs:element name="uap:MediaPlayback" type="uap:CT_MediaPlayback"/>
        <xs:element name="uap:VoipCall" type="uap:CT_VoipCall"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ApplicationExtensionCategory_Uap" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
    <xs:unique name="AppointmentsProvider_Verb">
      <xs:selector xpath="uap:AppointmentsProvider/uap:AppointmentsProviderLaunchActions/uap:LaunchAction"/>
      <xs:field xpath="@Verb"/>
    </xs:unique>
  </xs:element>

  <xs:element name="uap:FileTypeAssociationChoice" abstract="true"/>
  <xs:element name="uap:FileTypeAssociation" substitutionGroup="uap:FileTypeAssociationChoice" type="uap:CT_FileTypeAssociation"/>

  <xs:element name="uap:ProtocolChoice" abstract="true"/>
  <xs:element name="uap:Protocol" substitutionGroup="uap:ProtocolChoice" type="uap:CT_Protocol"/>

  <xs:element name="uap:AppServiceChoice" abstract="true"/>
  <xs:element name="uap:AppService" substitutionGroup="uap:AppServiceChoice" type="uap:CT_AppService"/>

  <xs:complexType name="uap:CT_FileTypeAssociation">
    <xs:all>
      <xs:element name="uap:DisplayName" type="t:ST_DisplayName" minOccurs="0"/>
      <xs:element name="uap:Logo" type="t:ST_ImageFile" minOccurs="0"/>
      <xs:element name="uap:InfoTip" type="t:ST_FTAInfoTip" minOccurs="0"/>
      <xs:element name="uap:EditFlags" minOccurs="0">
        <xs:complexType>
          <xs:attribute name="OpenIsSafe" type="xs:boolean" use="optional"/>
          <xs:attribute name="AlwaysUnsafe" type="xs:boolean" use="optional"/>
        </xs:complexType>
      </xs:element>
      <xs:element name="uap:SupportedFileTypes" type="uap:CT_FTASupportedFileTypes"/>
      <xs:element ref="uap:FileTypeAssociationSupportedVerbsChoice" minOccurs="0"/>
      <xs:element ref="uap4:KindMap" minOccurs="0"/>
      <xs:element ref="rescap3:MigrationProgIds" minOccurs="0"/>
      <xs:element ref="desktop2:ThumbnailHandler" minOccurs="0"/>
      <xs:element ref="desktop2:DesktopPreviewHandler" minOccurs="0"/>
      <xs:element ref="desktop2:DesktopPropertyHandler" minOccurs="0"/>
      <xs:element ref="desktop2:OleClass" minOccurs="0"/>
      <xs:element ref="desktop3:PropertyLists" minOccurs="0"/>
    </xs:all>
    <xs:attribute name="Name" type="t:ST_FTAName" use="required"/>
    <xs:attribute name="DesiredView" type="t:ST_DesiredView" use="optional"/>
    <xs:attribute ref="desktop2:UseUrl" use="optional"/>
    <xs:attribute ref="desktop2:AllowSilentDefaultTakeOver" use="optional"/>
    <xs:attribute ref="desktop5:ThumbnailTypeOverlay" use="optional"/>
    <xs:attribute ref="uap8:Launch" use="optional"/>
  </xs:complexType>

  <xs:element name="uap:FileTypeAssociationSupportedVerbsChoice" abstract="true"/>

  <xs:complexType name="uap:CT_FTASupportedFileTypes">
    <xs:sequence>
      <xs:element name="uap:FileType" maxOccurs="1000" >
        <xs:complexType>
          <xs:simpleContent>
            <xs:extension base="t:ST_FileType">
              <xs:attribute name="ContentType" type="t:ST_ContentType" use="optional"/>
              <xs:attributeGroup ref="uap4:ShellNewAttributes"/>
            </xs:extension>
          </xs:simpleContent>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="uap:CT_Protocol">
    <xs:all>
      <xs:element name="uap:Logo" type="t:ST_ImageFile" minOccurs="0"/>
      <xs:element name="uap:DisplayName" type="t:ST_DisplayName" minOccurs="0"/>
      <xs:element ref="rescap3:MigrationProgIds" minOccurs="0"/>
    </xs:all>
    <xs:attribute name="Name" type="t:ST_Protocol_2010_v2" use="required"/>
    <xs:attribute name="DesiredView" type="t:ST_DesiredView" use="optional"/>
    <xs:attribute name="ReturnResults" type="t:ST_ProtocolReturnResults" use="optional"/>
  </xs:complexType>

  <xs:complexType name="uap:CT_DialProtocol">
    <xs:attribute name="Name" type="t:ST_DialProtocol" use="required"/>
  </xs:complexType>

  <xs:complexType name="uap:CT_AutoPlayContent">
    <xs:sequence>
      <xs:element name="uap:LaunchAction" maxOccurs="1000">
        <xs:complexType>
          <xs:attribute name="Verb" type="t:ST_AutoPlayVerb" use="required"/>
          <xs:attribute name="ActionDisplayName" type="t:ST_DisplayName" use="required"/>
          <xs:attribute name="ContentEvent" type="t:ST_AutoPlayEvent" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="uap:CT_AutoPlayDevice">
    <xs:sequence>
      <xs:element name="uap:LaunchAction" maxOccurs="1000">
        <xs:complexType>
          <xs:attribute name="Verb" type="t:ST_AutoPlayVerb" use="required"/>
          <xs:attribute name="ActionDisplayName" type="t:ST_DisplayName" use="required"/>
          <xs:attribute name="DeviceEvent" type="t:ST_AutoPlayEvent" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="uap:CT_ShareTarget">
    <xs:sequence>
      <xs:element name="uap:SupportedFileTypes" type="uap:CT_CharmsSupportedFileTypes" minOccurs="0"/>
      <xs:element name="uap:DataFormat" type="t:ST_DataFormat" minOccurs="0" maxOccurs="10000"/>
    </xs:sequence>
    <xs:attribute name="Description" type="t:ST_ShareTargetDescription" use="optional"/>
  </xs:complexType>

  <xs:complexType name="uap:CT_FilePicker">
    <xs:sequence>
      <xs:element name="uap:SupportedFileTypes" type="uap:CT_CharmsSupportedFileTypes"/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="uap:CT_CharmsSupportedFileTypes">
    <xs:choice>
      <xs:element name="uap:FileType" minOccurs="1" maxOccurs="10000" type="t:ST_FileType"/>
      <xs:element name="uap:SupportsAnyFileType" minOccurs="1" maxOccurs="1"/>
    </xs:choice>
  </xs:complexType>

  <xs:complexType name="uap:CT_AppointmentsProvider">
    <xs:all>
      <xs:element name="uap:AppointmentsProviderLaunchActions" minOccurs="0">
        <xs:complexType>
          <xs:sequence>
            <xs:element ref="uap:LaunchAction" minOccurs="0" maxOccurs="10"/>
          </xs:sequence>
          <xs:attribute name="DesiredView" type="t:ST_DesiredView" use="optional"/>
        </xs:complexType>
      </xs:element>
    </xs:all>
  </xs:complexType>

  <xs:element name="uap:LaunchAction">
    <xs:complexType>
      <xs:attribute name="Verb" type="t:ST_AppointmentsProviderLaunchActionVerbs_Uap" use="required"/>
      <xs:attribute name="DesiredView" type="t:ST_DesiredView" use="optional"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="uap:CT_WebAccountProvider">
    <xs:sequence>
      <xs:element name="uap:ManagedUrls" type="uap:CT_ManagedUrls" minOccurs="0" maxOccurs="1"/>
    </xs:sequence>
    <xs:attribute name="Url" type="t:ST_WebAccountProviderUrl" use="required"/>
    <xs:attribute name="BackgroundEntryPoint" type="t:ST_EntryPoint" use="required"/>
  </xs:complexType>

  <xs:complexType name="uap:CT_ManagedUrls">
    <xs:sequence>
      <xs:element name="uap:Url" type="t:ST_WebAccountProviderUrl"  minOccurs="1" maxOccurs="200"/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="uap:CT_AppService">
    <xs:attribute name="Name" type="t:ST_AppServiceName" use="required"/>
    <xs:attribute name="ServerName" type="t:ST_AsciiWindowsId" use="optional"/>
    <xs:attribute ref="uap4:SupportsMultipleInstances" use="optional"/>
  </xs:complexType>

  <xs:complexType name="uap:CT_MediaPlayback">
    <xs:sequence>
      <xs:element name="uap:Codec" minOccurs="1" maxOccurs="100">
        <xs:complexType>
          <xs:attribute name="Name" type="t:ST_NonEmptyString" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="uap:CT_VoipCall">
    <xs:all>
      <xs:element name="uap:VoipCallUpgrade" minOccurs="0" maxOccurs="1">
        <xs:complexType>
          <xs:attribute name="SeamlessCallUpgrade" type="xs:boolean" use="optional"/>
        </xs:complexType>
      </xs:element>
      <xs:element name="uap:VoipDialPhoneNumber" minOccurs="0" maxOccurs="1"/>
    </xs:all>
  </xs:complexType>

  <xs:element name="uap:Task" substitutionGroup="f:BackgroundTaskChoice">
    <xs:complexType>
      <xs:attribute name="Type" type="t:ST_BackgroundTasks_Uap" use="required"/>
    </xs:complexType>
  </xs:element>

  <!-- UapManifestSchema_v2.xsd -->
  <xs:element name="uap2:Capability" substitutionGroup="f:CapabilityChoice">
    <xs:complexType>
      <xs:attribute name="Name" type="t:ST_Capability_Uap_2" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="uap2:SupportedVerbs" substitutionGroup="uap:FileTypeAssociationSupportedVerbsChoice">
    <xs:complexType>
      <xs:choice>
        <xs:element ref="uap2:VerbChoice" minOccurs="0" maxOccurs="10000"/>
      </xs:choice>
    </xs:complexType>
    <xs:unique name="UniqueVerbId">
      <xs:selector xpath="uap2:Verb | uap3:Verb"/>
      <xs:field xpath="@Id"/>
    </xs:unique>
  </xs:element>

  <xs:element name="uap2:VerbChoice" abstract="true"/>
  <xs:element name="uap2:Verb" substitutionGroup="uap2:VerbChoice" type="uap2:CT_Verb"/>

  <xs:complexType name="uap2:CT_Verb">
    <xs:simpleContent>
      <xs:extension base="t:ST_NonEmptyString">
        <xs:attribute name="Id" use="required" type="t:ST_FileTypeAssociationSupportedVerbId"/>
        <xs:attribute name="Extended" use="optional" type="xs:boolean"/>
        <xs:attribute ref="uap7:Default" use="optional"/>
        <xs:attributeGroup ref="rescap3:DdeExecAttributes"/>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>

  <xs:element name="uap2:Extension" substitutionGroup="f:ApplicationExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="uap2:WebAccountProvider" type="uap2:CT_WebAccountProvider"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ApplicationExtensionCategory_Uap2" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="uap2:CT_WebAccountProvider">
    <xs:sequence>
      <xs:element name="uap2:ManagedUrls" type="uap2:CT_ManagedUrls" minOccurs="0" maxOccurs="1"/>
    </xs:sequence>
    <xs:attribute name="Url" type="t:ST_WebAccountProviderUrl" use="required"/>
    <xs:attribute name="BackgroundEntryPoint" type="t:ST_EntryPoint" use="required"/>
    <xs:attribute name="DisplayName" type="t:ST_NonEmptyString" use="optional"/>
    <xs:attribute name="DisplayPurpose" type="t:ST_NonEmptyString" use="optional"/>
    <xs:attribute name="Square44x44Logo" type="t:ST_ImageFile" use="optional"/>
  </xs:complexType>

  <xs:complexType name="uap2:CT_ManagedUrls">
    <xs:sequence>
      <xs:element name="uap2:Url" type="t:ST_WebAccountProviderUrl"  minOccurs="1" maxOccurs="200"/>
    </xs:sequence>
  </xs:complexType>

  <!-- UapManifestSchema_v3.xsd -->
  <xs:element name="uap3:Capability" substitutionGroup="f:CapabilityChoice">
    <xs:complexType>
      <xs:attribute name="Name" type="t:ST_Capability_Uap_3" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="uap3:Extension" substitutionGroup="f:ApplicationExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="uap3:AppExtensionHost" type="uap3:CT_AppExtensionHost"/>
        <xs:element name="uap3:AppExtension" type="uap3:CT_AppExtension"/>
        <xs:element name="uap3:AppUriHandler" type="uap3:CT_AppUriHandler"/>
        <xs:element name="uap3:AppointmentDataProvider" type="uap3:CT_UserDataProvider"/>
        <xs:element name="uap3:EmailDataProvider" type="uap3:CT_UserDataProvider"/>
        <xs:element name="uap3:ContactDataProvider" type="uap3:CT_UserDataProvider"/>
        <xs:element name="uap3:AppExecutionAlias" type="uap3:CT_AppExecutionAlias"/>
        <xs:element name="uap3:AppService" type="uap3:CT_AppService"/>
        <xs:element name="uap3:Protocol" type="uap3:CT_Protocol"/>
        <xs:element name="uap3:FileTypeAssociation" type="uap3:CT_FileTypeAssociation"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ApplicationExtensionCategory_Uap3" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="uap3:CT_AppExecutionAlias">
    <xs:sequence>
      <xs:element ref="uap3:ExecutionAliasChoice" minOccurs="0" maxOccurs="100"/>
    </xs:sequence>
  </xs:complexType>

   <xs:element name="uap3:ExecutionAliasChoice" abstract="true"/>

  <xs:complexType name="uap3:CT_AppExtensionHost">
    <xs:sequence>
      <xs:element name="uap3:Name" type="t:ST_AppServiceName" minOccurs="1" maxOccurs="unbounded"/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="uap3:CT_AppExtension">
    <xs:sequence>
      <xs:element name="uap3:Properties" minOccurs="0" maxOccurs="1">
        <!-- Under this node, Edge extension developers can put in custom data to pass to Edge,
             so we are relaxing schema validations to allow custom data -->
        <xs:complexType>
          <xs:sequence>
            <xs:any minOccurs="0" maxOccurs="unbounded" processContents="skip"/>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="Name" type="t:ST_AppServiceNameLonger" use="required"/>
    <xs:attribute name="Id" type="t:ST_AppServiceName" use="required"/>
    <xs:attribute name="PublicFolder" type="t:ST_FileName" use="optional"/>
    <xs:attribute name="DisplayName" type="t:ST_DisplayName" use="required"/>
    <xs:attribute name="Description" type="t:ST_Description" use="optional"/>
  </xs:complexType>

  <xs:complexType name="uap3:CT_AppUriHandler">
    <xs:sequence>
      <xs:element name="uap3:Host" minOccurs="0" maxOccurs="1000">
        <xs:complexType>
          <xs:attribute name="Name" type="t:ST_DomainName" use="required"/>
        </xs:complexType>
      </xs:element>
      <xs:element ref="uap5:Host" minOccurs="0" maxOccurs="1000" />
    </xs:sequence>
    <xs:attribute ref="desktop2:Parameters" use="optional"/>
    <xs:attribute ref="uap7:Name" use="optional"/>
  </xs:complexType>

  <xs:complexType name="uap3:CT_UserDataProvider">
    <xs:attribute name="ServerName" type="t:ST_NonEmptyString" use="optional"/>
  </xs:complexType>

  <xs:element name="uap3:VisualElements" type="uap3:CT_VisualElements" substitutionGroup="f:VisualElementsChoice">
    <xs:unique name="InitialRotationPreference_Name">
      <xs:selector xpath="uap:InitialRotationPreference/uap:Rotation"/>
      <xs:field xpath="@Preference"/>
    </xs:unique>
  </xs:element>

  <xs:complexType name="uap3:CT_VisualElements">
    <xs:complexContent>
      <xs:extension base="uap:CT_VisualElements">
        <xs:attribute name="VisualGroup" type="t:ST_NonPathDisplayName" use="optional"/>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="uap3:MainPackageDependency" substitutionGroup="f:MainPackageDependencyChoice">
    <xs:complexType>
      <xs:attribute name="Name" type="t:ST_PackageName" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="uap3:FileTypeAssociation" type="uap3:CT_FileTypeAssociation" substitutionGroup="uap:FileTypeAssociationChoice"/>
  <xs:complexType name="uap3:CT_FileTypeAssociation">
    <xs:complexContent>
      <xs:extension base="uap:CT_FileTypeAssociation">
        <xs:attribute name="Parameters" type="t:ST_Parameters" use="optional"/>
        <xs:attribute name="MultiSelectModel" type ="uap3:ST_MultiSelectModel" use="optional"/>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="uap3:Protocol" substitutionGroup="uap:ProtocolChoice" type="uap3:CT_Protocol"/>
  <xs:complexType name="uap3:CT_Protocol">
    <xs:complexContent>
      <xs:extension base="uap:CT_Protocol">
        <xs:attribute name="Parameters" type="t:ST_Parameters" use="optional"/>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <xs:element name="uap3:Verb" substitutionGroup="uap2:VerbChoice" type="uap3:CT_Verb"/>
  <xs:complexType name="uap3:CT_Verb">
    <xs:simpleContent>
      <xs:extension base="uap2:CT_Verb">
        <xs:attribute name="Parameters" type="t:ST_Parameters" use="optional"/>
        <xs:attribute name="MultiSelectModel" type ="uap3:ST_MultiSelectModel" use="optional"/>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>

  <xs:simpleType name="uap3:ST_MultiSelectModel">
    <xs:restriction base="xs:string">
      <xs:enumeration value="Player"/>
      <xs:enumeration value="Document"/>
      <xs:enumeration value="Single"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:element name="uap3:AppService" substitutionGroup="uap:AppServiceChoice" type="uap3:CT_AppService"/>
  <xs:complexType name="uap3:CT_AppService">
    <xs:complexContent>
      <xs:extension base="uap:CT_AppService">
        <xs:attribute name="SupportsRemoteSystems" type="xs:boolean" use="optional"/>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>

  <!-- UapManifestSchema_v4.xsd -->
  <xs:element name="uap4:MainPackageDependency" substitutionGroup="f:MainPackageDependencyChoice2">
    <xs:complexType>
      <xs:attribute name="Name" type="t:ST_PackageName" use="required"/>
      <xs:attribute name="Publisher" type="t:ST_Publisher_2010_v2" use="optional"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="uap4:KindMap">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="uap4:Kind" maxOccurs="100">
          <xs:complexType>
            <xs:attribute name="Value" type="uap4:ST_KindValue" use="required"/>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
    <xs:unique name="Kind_Value">
      <xs:selector xpath="uap4:Kind"/>
      <xs:field xpath="@Value"/>
    </xs:unique>
  </xs:element>

  <xs:simpleType name="uap4:ST_KindValue">
    <xs:restriction base="xs:string">
      <xs:enumeration value="searchfolder"/>
      <xs:enumeration value="webhistory"/>
      <xs:enumeration value="folder"/>
      <xs:enumeration value="feed"/>
      <xs:enumeration value="communication"/>
      <xs:enumeration value="program"/>
      <xs:enumeration value="document"/>
      <xs:enumeration value="calendar"/>
      <xs:enumeration value="game"/>
      <xs:enumeration value="link"/>
      <xs:enumeration value="video"/>
      <xs:enumeration value="contact"/>
      <xs:enumeration value="email"/>
      <xs:enumeration value="task"/>
      <xs:enumeration value="journal"/>
      <xs:enumeration value="note"/>
      <xs:enumeration value="instantmessage"/>
      <xs:enumeration value="unknown"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:attributeGroup name="uap4:ShellNewAttributes">
    <xs:attribute name="ShellNewFileName" type="t:ST_FileName" form="qualified" use="optional"/>
    <xs:attribute name="ShellNewDisplayName" type="t:ST_DisplayName" form="qualified" use="optional"/>
  </xs:attributeGroup>

  <xs:attribute name="uap4:SupportsMultipleInstances" type="xs:boolean"/>

  <xs:element name="uap4:Extension" substitutionGroup="f:ApplicationExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="uap4:SharedFonts" type="uap4:CT_SharedFonts"/>
        <xs:element name="uap4:UserDataTaskDataProvider" type="uap3:uap4:CT_UserDataProvider"/>
        <xs:element name="uap4:MediaCodec" type="uap4:CT_MediaCodec"/>
        <xs:element name="uap4:ContactPanel" type="uap4:CT_ContactPanel"/>
        <xs:element name="uap4:LoopbackAccessRules" type="uap4:CT_LoopbackAccessRules"/>
        <xs:element name="uap4:DevicePortalProvider" type="uap4:CT_DevicePortalProvider"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ApplicationExtensionCategory_Uap4" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
    <xs:unique name="SharedFonts_File">
      <xs:selector xpath="uap4:SharedFonts/uap4:Font"/>
      <xs:field xpath="@File"/>
    </xs:unique>
  </xs:element>

  <xs:complexType name="uap4:CT_SharedFonts">
    <xs:sequence>
      <xs:element name="uap4:Font" minOccurs="1" maxOccurs="unbounded">
        <xs:complexType>
          <xs:attribute name="File" type="t:ST_FileName" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:element name="uap4:Capability" substitutionGroup="f:CapabilityChoice">
    <xs:complexType>
      <xs:attribute name="Name" type="t:ST_Capability_Uap_4" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="uap4:CustomCapability" substitutionGroup="f:CustomCapabilityChoice">
    <xs:complexType>
      <xs:attribute name="Name" type="uap4:ST_CustomCapability" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:simpleType name="uap4:ST_CustomCapability">
    <xs:restriction base="t:ST_NonEmptyString">
      <!-- The format is company.capabilitynamefromstore_publisherId -->
      <xs:pattern value="[A-Za-z0-9][-_.A-Za-z0-9]*_[a-hjkmnp-z0-9]{13}"/>
      <xs:minLength value="15"/>
      <xs:maxLength value="255"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:complexType name="uap4:CT_MediaCodec">
    <xs:all>
      <xs:element name="uap4:MediaEncodingProperties">
        <xs:complexType>
          <xs:all>
            <xs:element name="uap4:InputTypes">
              <xs:complexType>
                <xs:sequence>
                  <xs:element name="uap4:InputType" type="uap4:CT_MediaCodecInput" minOccurs="1" maxOccurs="1000"/>
                </xs:sequence>
              </xs:complexType>
            </xs:element>
            <xs:element name="uap4:OutputTypes">
              <xs:complexType>
                <xs:sequence>
                  <xs:element name="uap4:OutputType" type="uap4:CT_MediaCodecOutput" minOccurs="1" maxOccurs="1000"/>
                </xs:sequence>
              </xs:complexType>
            </xs:element>
          </xs:all>
        </xs:complexType>
      </xs:element>
    </xs:all>
    <xs:attribute name="DisplayName" type="t:ST_DisplayName" use="required"/>
    <xs:attribute name="Description" type="t:ST_Description" use="required"/>
    <xs:attribute name="Category" type="uap4:ST_MediaCodecCategory" use="required"/>
    <xs:attribute name="AppServiceName" type="t:ST_AppServiceName" use="optional"/>
    <xs:attributeGroup ref="wincap3:InprocMediaCodecAttributes"/>
  </xs:complexType>

  <xs:simpleType name="uap4:ST_MediaCodecCategory">
    <xs:restriction base="xs:string">
      <xs:enumeration value="audioDecoder"/>
      <xs:enumeration value="audioEncoder"/>
      <xs:enumeration value="videoDecoder"/>
      <xs:enumeration value="videoEncoder"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:complexType name="uap4:CT_MediaCodecInput">
    <xs:attribute name="SubType" type="t:ST_MediaCodecSubType" use="required" />
    <xs:attribute ref="uap5:MkvCodecId" use="optional" />
    <xs:attribute ref="uap6:CodecMimeType" use="optional"/>
  </xs:complexType>

  <xs:complexType name="uap4:CT_MediaCodecOutput">
    <xs:attribute name="SubType" type="t:ST_MediaCodecSubType" use="required" />
  </xs:complexType>

  <xs:complexType name="uap4:CT_ContactPanel">
    <xs:attribute name="SupportsUnknownContacts" type="xs:boolean"/>
  </xs:complexType>

  <xs:complexType name="uap4:CT_LoopbackAccessRules">
    <xs:sequence>
      <xs:element name="uap4:Rule" minOccurs="0" maxOccurs="1000">
        <xs:complexType>
          <xs:attribute name="Direction" type="uap4:ST_LoopbackAccessDirection" use="required"/>
          <xs:attribute name="PackageFamilyName" type="t:ST_NonEmptyString" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:simpleType name="uap4:ST_LoopbackAccessDirection">
    <xs:restriction base="xs:string">
      <xs:enumeration value="in"/>
      <xs:enumeration value="out"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:complexType name="uap4:CT_DevicePortalProvider">
    <xs:all>
      <xs:element ref="uap8:Tools" minOccurs="0" />
      <xs:element ref="uap8:Workspaces" minOccurs="0"/>
    </xs:all>
    <xs:attribute name="DisplayName" type="t:ST_DisplayName" use="required"/>
    <xs:attribute name="AppServiceName" type="t:ST_AppServiceName" use="required"/>
    <xs:attribute name="ContentRoute" type="t:ST_NonEmptyString" use="optional"/>
    <xs:attribute name="HandlerRoute" type="t:ST_NonEmptyString" use="optional"/>
  </xs:complexType>

  <!-- UapManifestSchema_v5.xsd -->
  <xs:element name="uap5:Extension" substitutionGroup="f:ApplicationExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="uap5:UserActivity" type="uap5:CT_UserActivity"/>
        <xs:element name="uap5:MediaSource" type="uap5:CT_MediaSource"/>
        <xs:element name="uap5:VideoRendererEffect" type="uap5:CT_VideoRendererEffect"/>
        <xs:element name="uap5:OutOfProcessServer" type="uap5:CT_OutOfProcessServer"/>
        <xs:element name="uap5:StartupTask" type="uap5:CT_StartupTask"/>
        <xs:element name="uap5:AppExecutionAlias" type="uap5:CT_AppExecutionAlias"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ApplicationExtensionCategory_Uap5" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="uap5:CT_UserActivity">
    <xs:attribute name="uap5:ActivitySourceHost" type="t:ST_DomainName"/>
  </xs:complexType>

  <xs:attributeGroup name="uap5:SplashScreenAttributes">
    <xs:attribute name="Optional" type="xs:boolean" form="qualified" use="optional"/>
  </xs:attributeGroup>

  <xs:attributeGroup name="uap5:ContentUriRuleAttributes">
    <xs:attribute name="ServiceWorker" type="xs:boolean" form="qualified" use="optional"/>
  </xs:attributeGroup>

  <xs:element name="uap5:MixedRealityModel">
    <xs:complexType>
      <xs:all>
        <xs:element ref="uap6:SpatialBoundingBox" minOccurs="0" maxOccurs="1"/>
      </xs:all>
      <xs:attribute name="Path" type="t:ST_FileName" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="uap5:Host">
    <xs:complexType>
      <xs:attribute name="Name" type="t:ST_DomainNameWithStarSubDomain" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="uap5:CT_MediaSource">
    <xs:all minOccurs="0">
      <xs:element name="uap5:SupportedFileTypes">
        <xs:complexType>
          <xs:sequence minOccurs="0" maxOccurs="1000">
            <xs:element name="uap5:FileType" type="t:ST_FileType" />
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element name="uap5:SupportedContentTypes">
        <xs:complexType>
          <xs:sequence minOccurs="0" maxOccurs="1000">
            <xs:element name="uap5:ContentType">
              <xs:complexType>
                <xs:attribute name="SubType" type="t:ST_ContentType" use="required"/>
              </xs:complexType>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
    </xs:all>
    <xs:attribute name="DisplayName" type="t:ST_DisplayName"/>
    <xs:attribute name="Description" type="t:ST_Description"/>
    <xs:attribute name="AppServiceName" type="t:ST_AppServiceName" use="required"/>
  </xs:complexType>

  <xs:complexType name="uap5:CT_VideoRendererEffect">
    <xs:all minOccurs="0">
      <xs:element name="uap5:VideoRendererExtensionProfiles">
        <xs:complexType>
          <xs:sequence minOccurs="0" maxOccurs="1000">
            <xs:element name="uap5:VideoRendererExtensionProfile">
              <xs:complexType>
                <xs:attribute name="Profile" type="t:ST_NonEmptyString" use="required"/>
              </xs:complexType>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element name="uap5:InputTypes">
        <xs:complexType>
          <xs:sequence minOccurs="0" maxOccurs="1000">
            <xs:element name="uap5:InputType">
              <xs:complexType>
                <xs:attribute name="SubType" type="t:ST_MediaCodecSubType" use="required" />
                <xs:attribute name="MkvCodecId" type="t:ST_NonEmptyString" use="optional" />
              </xs:complexType>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
    </xs:all>
    <xs:attribute name="DisplayName" type="t:ST_DisplayName"/>
    <xs:attribute name="Description" type="t:ST_Description"/>
    <xs:attributeGroup ref="wincap3:InprocMediaCodecAttributes"/>
  </xs:complexType>

  <xs:attribute name="uap5:MkvCodecId" type="t:ST_NonEmptyString"/>

  <xs:complexType name="uap5:CT_OutOfProcessServer">
    <xs:sequence>
      <xs:element name="uap5:Path" type="t:ST_ExecutableAnyCase"/>
      <xs:element name="uap5:Arguments" type="t:ST_NonEmptyString" minOccurs="0"/>
      <xs:element name="uap5:Instancing" type="t:ST_Instancing"/>
      <xs:element name="uap5:ActivatableClass" type="uap5:CT_OutOfProcessActivatableClass" maxOccurs="65535"/>
    </xs:sequence>
    <xs:attribute name="ServerName" type="t:ST_AsciiWindowsId" use="required"/>
    <xs:attribute name="RunFullTrust" type="xs:boolean"/>
  </xs:complexType>

  <xs:complexType name="uap5:CT_OutOfProcessActivatableClass">
    <xs:sequence>
      <xs:element name="uap5:ActivatableClassAttribute" type="t:CT_ActivatableClassAttribute" minOccurs="0" maxOccurs="1000"/>
    </xs:sequence>
    <xs:attribute name="ActivatableClassId" type="t:ST_ActivatableClassId" use="required"/>
  </xs:complexType>

  <xs:attributeGroup name="uap5:OutOfProcessServerFullTrustAttributes">
    <xs:attribute name="RunFullTrust" type="xs:boolean" form="qualified"/>
    <xs:attribute name="IdentityType" type="uap5:ST_IdentityType" form="qualified"/>
  </xs:attributeGroup>

  <xs:simpleType name="uap5:ST_IdentityType">
    <xs:restriction base="xs:string">
      <xs:enumeration value="activateAsPackage"/>
      <xs:enumeration value="activateAsActivator"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:complexType name="uap5:CT_StartupTask">
    <xs:attribute name="TaskId" type="t:ST_NonEmptyString" use="required"/>
    <xs:attribute name="Enabled" type="xs:boolean" use="optional"/>
    <xs:attribute name="DisplayName" type="t:ST_DisplayName" use="optional"/>
  </xs:complexType>

  <xs:complexType name="uap5:CT_AppExecutionAlias">
    <xs:sequence minOccurs="0" maxOccurs="1000">
      <xs:element name="uap5:ExecutionAlias" minOccurs="0">
        <xs:complexType>
          <xs:attribute name="Alias" type="t:ST_ExecutableNoPath" use="required"/>
          <xs:attribute ref="uap8:AllowOverride" use="optional"/>
        </xs:complexType>
      </xs:element>
      <xs:element ref="uap8:ExecutionAlias" minOccurs="0"/>
    </xs:sequence>
    <xs:attribute ref="desktop4:Subsystem" use="optional"/>
    <xs:attribute ref="iot2:Subsystem" use="optional"/>
  </xs:complexType>

  <xs:element name="uap5:DriverDependency">
    <xs:complexType>
      <xs:sequence minOccurs="0" maxOccurs="1000">
        <xs:element name="uap5:DriverConstraint">
          <xs:complexType>
            <xs:attribute name="Name" type="t:ST_NonEmptyString" use="required"/>
            <xs:attribute name="MinVersion" type="t:ST_VersionQuadNoneZero"/>
            <xs:attribute name="MinDate" type="t:ST_Date"/>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
    <xs:unique name="DriverConstraint_Name">
      <xs:selector xpath="uap5:DriverConstraint"/>
      <xs:field xpath="@Name"/>
    </xs:unique>
  </xs:element>

  <!-- UapManifestSchema_v6.xsd -->
  <xs:element name="uap6:AllowExecution" type="xs:boolean"/>

  <xs:element name="uap6:Extension" substitutionGroup="f:ExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="uap6:BarcodeScannerProvider" type="uap6:CT_BarcodeScannerProvider"/>
        <xs:element name="uap6:LocalExperiencePack" type="uap6:CT_LocalExperiencePack"/>
        <xs:element name="uap6:LoaderSearchPathOverride" type="uap6:CT_LoaderSearchPathOverride"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ExtensionCategory_Uap6" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="uap6:CT_BarcodeScannerProvider">
    <xs:attribute name="DisplayName" type="t:ST_DisplayName"/>
    <xs:attribute name="SupportsVideoPreview" type="xs:boolean"/>
  </xs:complexType>

  <xs:complexType name="uap6:CT_LocalExperiencePack">
    <xs:attribute name="Language" type="xs:language" use="required"/>
  </xs:complexType>

  <xs:element name="uap6:SpatialBoundingBox">
    <xs:complexType>
      <xs:attribute name="Center" type="uap6:ST_Vector3" use="required"/>
      <xs:attribute name="Extents" type="uap6:ST_Vector3PositiveOrAuto" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:simpleType name="uap6:ST_Vector3">
    <xs:restriction base="t:ST_NonEmptyString">
      <xs:pattern value="\-?[0-9]*\.?[0-9]+,\-?[0-9]*\.?[0-9]+,\-?[0-9]*\.?[0-9]+"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="uap6:ST_Vector3PositiveOrAuto">
    <xs:restriction base="t:ST_NonEmptyString">
      <xs:pattern value="([1-9]+(\.[0-9]+)?|[0-9]*\.[0-9]*[1-9]),([1-9]+(\.[0-9]+)?|[0-9]*\.[0-9]*[1-9]),([1-9]+(\.[0-9]+)?|[0-9]*\.[0-9]*[1-9])"/>
      <xs:pattern value="Auto"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:attribute name="uap6:CodecMimeType" type="t:ST_NonEmptyString"/>

  <xs:complexType name="uap6:CT_LoaderSearchPathOverride">
    <xs:sequence minOccurs="0" maxOccurs="5">
      <xs:element name="uap6:LoaderSearchPathEntry">
        <xs:complexType>
          <xs:attribute name="FolderPath" type="uap6:ST_FileNameOrEmpty" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:simpleType name="uap6:ST_EmptyString">
    <xs:restriction base="xs:string">
      <xs:pattern value=""/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="uap6:ST_FileNameOrEmpty">
    <xs:union memberTypes="uap6:ST_EmptyString t:ST_FileName"/>
  </xs:simpleType>

  <xs:attribute name="uap6:Optional" type="xs:boolean"/>

  <xs:element name="uap6:Capability" substitutionGroup="f:CapabilityChoice">
    <xs:complexType>
      <xs:attribute name="Name" type="t:ST_Capability_Uap_6" use="required"/>
    </xs:complexType>
  </xs:element>

  <!-- UapManifestSchema_v7.xsd -->
  <xs:element name="uap7:Extension" substitutionGroup="f:ExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="uap7:SharedFonts" type="uap4:CT_SharedFonts"/>
        <xs:element name="uap7:EnterpriseDataProtection" type="uap7:CT_EnterpriseDataProtection"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ExtensionCategory_Uap7" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="uap7:CT_EnterpriseDataProtection">
    <xs:attribute name="ProtectionMode" type="uap7:ST_ProtectionMode" use="required"/>
  </xs:complexType>

  <xs:simpleType name="uap7:ST_ProtectionMode">
    <xs:restriction base="xs:string">
      <xs:enumeration value="auto"/>
      <xs:enumeration value="default"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:element name="uap7:OSPackageDependency">
    <xs:complexType>
      <xs:attribute name="Name" type="t:ST_AsciiIdentifier" use="required"/>
      <xs:attribute name="Version" type="t:ST_VersionQuad" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:attribute name="uap7:Default" type="xs:boolean"/>

  <xs:element name="uap7:Properties">
    <xs:complexType>
      <xs:all>
        <xs:element name="uap7:ImportRedirectionTable" type="t:ST_DllFile" minOccurs="0"/>
        <xs:element ref="uap8:ActiveCodePage" minOccurs="0"/>
      </xs:all>
    </xs:complexType>
  </xs:element>

  <xs:attribute name="uap7:Name" type="t:ST_NonEmptyString"/>

  <xs:element name="uap7:Capability" substitutionGroup="f:CapabilityChoice">
    <xs:complexType>
      <xs:attribute name="uap7:Name" type="t:ST_Capability_Uap_7" use="required"/>
    </xs:complexType>
  </xs:element>

  <!-- UapManifestSchema_v8.xsd -->
  <xs:element name="uap8:Extension" substitutionGroup="f:ExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="uap8:PosPaymentConnector" type="uap8:CT_PosPaymentConnector"/>
        <xs:element name="uap8:DataProtection" type="uap8:CT_DataProtection"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ExtensionCategory_Uap8" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="uap8:CT_PosPaymentConnector">
    <xs:attribute name="DisplayName" type="t:ST_DisplayName" use="required"/>
  </xs:complexType>

  <xs:element name="uap8:ActiveCodePage" type="uap8:ST_ActiveCodePage" />

  <xs:simpleType name="uap8:ST_ActiveCodePage">
    <xs:restriction base="xs:string">
      <xs:enumeration value="UTF-8"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:element name="uap8:Tools">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="uap8:Tool" minOccurs="0" maxOccurs="1000">
          <xs:complexType>
            <xs:attribute name="DisplayName" type="t:ST_DisplayName" use="required"/>
            <xs:attribute name="Route" type="t:ST_NonEmptyString" use="required"/>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>

  <xs:element name="uap8:Workspaces">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="uap8:Workspace" minOccurs="0" maxOccurs="1000">
          <xs:complexType>
            <xs:attribute name="DisplayName" type="t:ST_DisplayName" use="required"/>
            <xs:attribute name="Route" type="t:ST_NonEmptyString" use="required"/>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>

  <xs:attribute name="uap8:Launch" type="uap8:ST_Launch"/>

  <xs:simpleType name="uap8:ST_Launch">
    <xs:restriction base="xs:string">
      <xs:enumeration value="file"/>
      <xs:enumeration value="placeholderFile"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:complexType name="uap8:CT_DataProtection">
    <xs:attribute name="UserDataAvailability" type="uap8:ST_UserDataAvailability" use="required"/>
  </xs:complexType>

  <xs:simpleType name="uap8:ST_UserDataAvailability">
    <xs:restriction base="xs:string">
      <xs:enumeration value="always"/>
      <xs:enumeration value="afterFirstUnlock"/>
      <xs:enumeration value="whileUnlocked"/>
      <xs:enumeration value="applicationManaged"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:attribute name="uap8:AllowOverride" type="xs:boolean"/>

  <xs:element name="uap8:ExecutionAlias" substitutionGroup="uap3:ExecutionAliasChoice">
    <xs:complexType>
      <xs:attribute name="Alias" type="t:ST_ExecutableNoPath" use="required"/>
      <xs:attribute ref="AllowOverride" use="optional"/>
    </xs:complexType>
  </xs:element>

  <!-- WindowsCapabilitiesManifestSchema.xsd -->
  <xs:element name="wincap:Capability" substitutionGroup="f:CapabilityChoice">
    <xs:complexType>
      <xs:attribute name="Name" type="t:ST_Capability_Windows_Restricted_Party" use="required"/>
    </xs:complexType>
  </xs:element>

  <!-- WindowsCapabilitiesManifestSchema_v3.xsd -->
  <!-- Starting RS2, wincap extensions will skip manifest validation -->
  <xs:element name="wincap3:Extension" substitutionGroup="f:ExtensionChoice">
    <xs:complexType>
      <xs:sequence>
        <xs:any minOccurs="0" maxOccurs="1" processContents="skip"/>
      </xs:sequence>
      <xs:attribute name="Category" type="t:ST_ExtensionCategory_Windows_Restricted_Party3" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:attributeGroup name="wincap3:InprocMediaCodecAttributes">
    <xs:attribute name="ActivatableClassId" type="t:ST_ActivatableClassId" form="qualified" use="optional"/>
    <xs:attribute name="Path" type="t:ST_DllFile" form="qualified" use="optional"/>
    <xs:attribute name="ProcessorArchitecture" type="t:ST_Architecture" form="qualified" use="optional"/>
  </xs:attributeGroup>

  <!-- IotManifestSchema_v2.xsd -->
  <xs:attribute name="iot2:Subsystem" type="t:ST_Subsystem"/>
  <xs:attribute name="iot2:SupportsMultipleInstances" type="xs:boolean"/>

  <!-- HolographicManifestSchema.xsd -->
  <xs:element name="holo:HoloContent" substitutionGroup="uap:HoloContentChoice" type="t:ST_FileName"/>

  <!-- IotManifestSchema.xsd -->
  <xs:element name="iot:Capability" substitutionGroup="f:CapabilityChoice">
    <xs:complexType>
      <xs:attribute name="Name" type="t:ST_Capability_Iot" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="iot:Task" substitutionGroup="f:BackgroundTaskChoice">
    <xs:complexType>
      <xs:attribute name="Type" type="t:ST_BackgroundTasks_Iot" use="required"/>
    </xs:complexType>
  </xs:element>

  <!-- MobileManifestSchema.xsd -->
    <xs:element name="mobile:Capability" substitutionGroup="f:CapabilityChoice">
    <xs:complexType>
      <xs:attribute name="Name" type="t:ST_Capability_Mobile" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="mobile:Extension" substitutionGroup="f:ApplicationExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="mobile:AowApp" type="mobile:CT_AowApp" />
        <xs:element name="mobile:MobileMultiScreenProperties" type="mobile:CT_MultiScreen"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_ApplicationExtensionCategory_Mobile" use="required" />
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="mobile:CT_AowApp">
    <xs:all>
      <xs:element name="mobile:PayloadName" type="t:ST_NonEmptyString" minOccurs="1"/>
      <xs:element name="mobile:PayloadVersion" type="t:ST_NonEmptyString" minOccurs="1"/>
    </xs:all>
  </xs:complexType>

  <xs:complexType name="mobile:CT_MultiScreen">
    <xs:attribute name="RestrictToInternalScreen" type="xs:boolean"/>
  </xs:complexType>

  <!-- RestrictedCapabilitiesManifestSchema_v2.xsd -->
  <xs:element name="rescap2:Extension" substitutionGroup="f:ApplicationExtensionChoice">
    <xs:complexType>
      <xs:attribute name="Category" type="t:ST_ApplicationExtensionCategory_Restricted2" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <!-- ServerManifestSchema.xsd -->
  <xs:simpleType name="serverpreview:ST_ApplicationExtensionCategory_Server">
    <xs:restriction base="xs:string">
      <xs:enumeration value="windows.ntServices"/>
      <xs:enumeration value="windows.wmiProviders"/>
      <xs:enumeration value="windows.performanceProviders"/>
      <xs:enumeration value="windows.eventProviders"/>
      <xs:enumeration value="windows.iisModules"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:element name="serverpreview:Extension" substitutionGroup="f:ApplicationExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="serverpreview:IisModules" type="serverpreview:CT_IisModules" minOccurs="0"/>
        <xs:element name="serverpreview:NTServices" type="serverpreview:CT_NTServices" minOccurs="0"/>
        <xs:element name="serverpreview:WmiProviders" type="serverpreview:CT_WmiProviders" minOccurs="0"/>
        <xs:element name="serverpreview:PerformanceProviders" type="serverpreview:CT_PerformanceProviders" minOccurs="0"/>
        <xs:element name="serverpreview:EventProviders" type="serverpreview:CT_EventProviders" minOccurs="0"/>
      </xs:choice>
      <xs:attribute name="Category" type="serverpreview:ST_ApplicationExtensionCategory_Server" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
    <xs:unique name="ModuleName">
      <xs:selector xpath="serverpreview:IisModules/serverpreview:IisModule" />
      <xs:field xpath="@Name" />
    </xs:unique>
    <xs:unique name="ModuleFileName">
      <xs:selector xpath="serverpreview:IisModules/serverpreview:IisModule" />
      <xs:field xpath="@ModuleDll" />
    </xs:unique>
    <xs:unique name="ModuleSchemaName">
      <xs:selector xpath="serverpreview:IisModules/serverpreview:IisModule" />
      <xs:field xpath="@SchemaFileName" />
    </xs:unique>
    <xs:unique name="TopLevelSectionDefinitionName">
      <xs:selector xpath="serverpreview:IisModules/serverpreview:IisModule/serverpreview:SectionDefinition" />
      <xs:field xpath="@Name" />
    </xs:unique>
    <xs:unique name="ServiceName">
      <xs:selector xpath="serverpreview:NTServices/serverpreview:NTService"/>
      <xs:field xpath="@Name"/>
    </xs:unique>
    <xs:unique name="ServiceDependencyName">
      <xs:selector xpath="serverpreview:NTServices/serverpreview:NTService/serverpreview:ServiceDependencies/serverpreview:ServiceDependency"/>
      <xs:field xpath="@Name"/>
    </xs:unique>
    <xs:unique name="InstallMofName">
      <xs:selector xpath="serverpreview:WmiProviders/serverpreview:WmiProvider/serverpreview:Mof"/>
      <xs:field xpath="@InstallMof"/>
    </xs:unique>
    <xs:unique name="UninstallMofName">
      <xs:selector xpath="serverpreview:WmiProviders/serverpreview:WmiProvider/serverpreview:Mof"/>
      <xs:field xpath="@UninstallMof"/>
    </xs:unique>
    <xs:unique name="PerformanceProviderManifestName">
      <xs:selector xpath="serverpreview:PerformanceProviders/serverpreview:PerformanceProvider"/>
      <xs:field xpath="@ManifestFile"/>
    </xs:unique>
    <xs:unique name="PerformanceProviderId">
      <xs:selector xpath="serverpreview:PerformanceProviders/serverpreview:PerformanceProvider"/>
      <xs:field xpath="@Id"/>
    </xs:unique>
    <xs:unique name="EventProviderManifestName">
      <xs:selector xpath="serverpreview:EventProviders/serverpreview:EventProvider"/>
      <xs:field xpath="@ManifestFile"/>
    </xs:unique>
    <xs:unique name="EventProviderId">
      <xs:selector xpath="serverpreview:EventProviders/serverpreview:EventProvider"/>
      <xs:field xpath="@Id"/>
    </xs:unique>
  </xs:element>

  <xs:complexType name="serverpreview:CT_IisModule">
    <xs:choice maxOccurs="100" minOccurs="0">
      <xs:element name="serverpreview:SectionGroupDefinition" type="serverpreview:CT_SectionGroupDefinition" />
      <xs:element name="serverpreview:SectionDefinition" type="serverpreview:CT_SectionDefinition" />
      <xs:element name="serverpreview:SectionData" type="serverpreview:CT_SectionData" />
    </xs:choice>
    <xs:attribute name="Name" type="t:ST_NonEmptyString" use="required" />
    <xs:attribute name="ModuleDll" type="serverpreview:ST_Dll" use="required" />
    <xs:attribute name="SchemaFileName" type="serverpreview:ST_XML" use="optional" />
  </xs:complexType>

  <xs:simpleType name="serverpreview:ST_OverrideModeDefault">
    <xs:restriction base="xs:string">
      <xs:enumeration value="allow"/>
      <xs:enumeration value="deny"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:complexType name="serverpreview:CT_SectionDefinition">
    <xs:attribute name="Name" type="t:ST_NonEmptyString" use="required" />
    <xs:attribute name="OverrideModeDefault" type="serverpreview:ST_OverrideModeDefault" use="optional" />
    <xs:attribute name="AllowDefinition" type="serverpreview:ST_AllowDefinition" use="optional" />
  </xs:complexType>

  <xs:complexType name="serverpreview:CT_SectionData">
    <xs:choice minOccurs="0" maxOccurs="unbounded">
      <xs:element name="serverpreview:CollectionElement" type="serverpreview:CT_CollectionElement" />
      <xs:element name="serverpreview:Attribute" type="serverpreview:CT_Attribute" />
    </xs:choice>
    <xs:attribute name="SectionPath" type="t:ST_NonEmptyString" use="required" />
    <xs:attribute name="SubPath" type="t:ST_NonEmptyString" use="optional" />
  </xs:complexType>

  <xs:complexType name="serverpreview:CT_CollectionElement">
    <xs:anyAttribute processContents="skip"/>
  </xs:complexType>

  <xs:complexType name="serverpreview:CT_Attribute">
    <xs:attribute name="Name" type="t:ST_NonEmptyString" use="required" />
    <xs:attribute name="Value" type="t:ST_NonEmptyString" use="required" />
  </xs:complexType>

  <xs:complexType name="serverpreview:CT_SectionGroupDefinition">
    <xs:sequence>
      <xs:element name="serverpreview:SectionGroupDefinition" type="serverpreview:CT_SectionGroupDefinition" minOccurs="0" maxOccurs="unbounded"/>
      <xs:element name="serverpreview:SectionDefinition" type="serverpreview:CT_SectionDefinition" minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>
    <xs:attribute name="Name" type="t:ST_NonEmptyString" use="required" />
  </xs:complexType>

  <xs:simpleType name="serverpreview:ST_AllowDefinition">
    <xs:restriction base="xs:string">
      <xs:enumeration value="machineOnly"/>
      <xs:enumeration value="machineToRootWeb"/>
      <xs:enumeration value="appHostOnly"/>
      <xs:enumeration value="machineToApplication"/>
      <xs:enumeration value="everywhere"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:complexType name="serverpreview:CT_IisModules">
    <xs:sequence>
        <xs:element name="serverpreview:IisModule" type="serverpreview:CT_IisModule" maxOccurs="100" />
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="serverpreview:CT_NTServices">
    <xs:sequence>
      <xs:element name="serverpreview:NTService" type="serverpreview:CT_NTService" maxOccurs="100"/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="serverpreview:CT_WmiProviders">
    <xs:sequence>
      <xs:element name="serverpreview:WmiProvider" type="serverpreview:CT_WmiProvider" maxOccurs="100"/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="serverpreview:CT_PerformanceProviders">
    <xs:sequence>
      <xs:element name="serverpreview:PerformanceProvider" type="serverpreview:CT_PerformanceProvider" maxOccurs="100"/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="serverpreview:CT_EventProviders">
    <xs:sequence>
      <xs:element name="serverpreview:EventProvider" type="serverpreview:CT_EventProvider" maxOccurs="100"/>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="serverpreview:CT_NTService">
    <xs:all>
      <xs:element name="serverpreview:ServiceDependencies" type="serverpreview:CT_ServiceDependencies" minOccurs="0"/>
      <xs:element name="serverpreview:ServiceParameters" type=" serverpreview:CT_NTServiceParameters" minOccurs="0"/>
    </xs:all>
    <xs:attribute name="Name" type="serverpreview:ST_ServiceName" use="required"/>
    <xs:attribute name="Executable" type="t:ST_ExecutableAnyCase" use="required"/>
    <xs:attribute name="StartupType" type="serverpreview:ST_ServiceStartupType" use="required"/>
    <xs:attribute name="StartAccount" type="serverpreview:ST_StartAccount" use="required"/>
    <xs:attribute name="DisplayName" type="serverpreview:ST_DisplayName" use="optional"/>
    <xs:attribute name="StartErrorAction" type="serverpreview:ST_ServiceStartErrorAction" use="optional"/>
    <xs:attribute name="StartParameters" type="t:ST_NonEmptyString" use="optional"/>
    <xs:attribute name="Description" type="t:ST_NonEmptyString" use="optional"/>
    <xs:attribute name="FailureRecoveryAction" type="serverpreview:ST_FailureRecoveryAction" use="optional"/>
  </xs:complexType>

  <xs:complexType name ="serverpreview:CT_ServiceDependencies">
    <xs:sequence>
      <xs:element name="serverpreview:ServiceDependency" maxOccurs="100">
        <xs:complexType>
          <xs:attribute name="Name" type="serverpreview:ST_ServiceName" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:simpleType name="serverpreview:ST_ServiceName">
    <xs:restriction base="t:ST_NonEmptyString">
      <xs:maxLength value="256"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="serverpreview:ST_ServiceStartupType">
    <xs:restriction base="xs:string">
      <xs:enumeration value="auto"/>
      <xs:enumeration value="manual"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="serverpreview:ST_DisplayName">
    <xs:restriction base="t:ST_NonEmptyString">
      <xs:maxLength value="256"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="serverpreview:ST_ServiceStartErrorAction">
    <xs:restriction base="xs:string">
      <xs:enumeration value="ignoreError"/>
      <xs:enumeration value="logError"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="serverpreview:ST_StartAccount">
    <xs:restriction base="xs:string">
      <xs:enumeration value="localSystem"/>
      <xs:enumeration value="localService"/>
      <xs:enumeration value="networkService"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="serverpreview:ST_FailureRecoveryAction">
    <xs:restriction base="xs:string">
      <xs:enumeration value="none"/>
      <xs:enumeration value="restartService"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:complexType name="serverpreview:CT_NTServiceParameters">
    <xs:sequence>
      <xs:choice minOccurs="1" maxOccurs="100">
        <xs:element name="serverpreview:ServiceParameterDword" type="serverpreview:CT_NTServiceParameterDword" minOccurs="1"/>
        <xs:element name="serverpreview:ServiceParameterString" type="serverpreview:CT_NTServiceParameterString" minOccurs="1"/>
        <xs:element name="serverpreview:ServiceParameterKey" type="serverpreview:CT_NTServiceParameterKey" minOccurs="1"/>
      </xs:choice>
    </xs:sequence>
  </xs:complexType>

  <xs:complexType name="serverpreview:CT_NTServiceParameterKey">
    <xs:attribute name="Subkey" type="t:ST_FileName" use="required"/>
  </xs:complexType>

  <xs:complexType name="serverpreview:CT_NTServiceParameterDword">
    <xs:attribute name="Name" type="serverpreview:ST_NTServiceParameterName" use="required"/>
    <xs:attribute name="Value" type="xs:unsignedInt" use="required"/>
    <xs:attribute name="Subkey" type="t:ST_FileName" use="optional"/>
  </xs:complexType>

  <xs:complexType name="serverpreview:CT_NTServiceParameterString">
    <xs:attribute name="Name" type="serverpreview:ST_NTServiceParameterName" use="required"/>
    <xs:attribute name="Value" type="t:ST_NonEmptyString" use="required"/>
    <xs:attribute name="Subkey" type="t:ST_FileName" use="optional"/>
  </xs:complexType>

  <xs:simpleType name="serverpreview:ST_NTServiceParameterName">
    <xs:restriction base="t:ST_NonEmptyString">
      <xs:maxLength value="16383"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:complexType name="serverpreview:CT_WmiProvider">
    <xs:sequence>
      <xs:element name="serverpreview:Mof" type="serverpreview:CT_Mof" maxOccurs="100"/>
    </xs:sequence>
    <xs:attribute name="Name" type="serverpreview:ST_WmiName" use="required"/>
    <xs:attribute name="Namespace" type="serverpreview:ST_WmiName" use="required"/>
    <xs:attribute name="HostingSpecification" type="serverpreview:ST_HostingSpecification" use="required"/>
    <xs:attribute name="HostingGroup" type="serverpreview:ST_HostingGroup" use="optional"/>
    <xs:attribute name="DecoupledProviderExecutable" type="t:ST_ExecutableAnyCase" use="optional"/>
  </xs:complexType>

  <xs:complexType name ="serverpreview:CT_Mof">
    <xs:attribute name="InstallMof" type="serverpreview:ST_Mof" use="required"/>
    <xs:attribute name="UninstallMof" type="serverpreview:ST_Mof" use="optional"/>
  </xs:complexType>

  <xs:simpleType name="serverpreview:ST_WmiName">
    <xs:restriction base="t:ST_NonEmptyString">
      <xs:maxLength value="1024"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="serverpreview:ST_Mof">
    <xs:restriction base="t:ST_FileName">
      <xs:pattern value=".+\.(mof)"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="serverpreview:ST_HostingSpecification">
    <xs:restriction base="xs:string">
      <xs:enumeration value="selfHost"/>
      <xs:enumeration value="decoupled:Com"/>
      <xs:enumeration value="localSystemHost"/>
      <xs:enumeration value="localSystemHostOrSelfHost"/>
      <xs:enumeration value="networkServiceHost"/>
      <xs:enumeration value="localServiceHost"/>
      <xs:enumeration value="networkServiceHostOrSelfHost"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="serverpreview:ST_HostingGroup">
    <xs:restriction base="t:ST_NonEmptyString">
      <xs:maxLength value="256"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:complexType name="serverpreview:CT_PerformanceProvider">
    <xs:attribute name="Id" type="t:ST_GUID" use="required"/>
    <xs:attribute name="ManifestFile" type="serverpreview:ST_XML" use="required"/>
    <xs:attribute name="ResourceFile" type="serverpreview:ST_ExeOrDll" use="required"/>
  </xs:complexType>

  <xs:simpleType name="serverpreview:ST_XML">
    <xs:restriction base="t:ST_FileName">
      <xs:pattern value=".+\.(xml)"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="serverpreview:ST_ExeOrDll">
    <xs:restriction base="t:ST_FileName">
      <xs:pattern value=".+\.(exe|dll)"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:complexType name="serverpreview:CT_EventProvider">
    <xs:attribute name="Id" type="t:ST_GUID" use="required"/>
    <xs:attribute name="ManifestFile" type="serverpreview:ST_MAN" use="required"/>
    <xs:attribute name="ResourceFile" type="serverpreview:ST_ExeOrDll" use="required"/>
    <xs:attribute name="MessageFile" type="serverpreview:ST_ExeOrDll" use="optional"/>
    <xs:attribute name="ParameterFile" type="serverpreview:ST_ExeOrDll" use="optional"/>
  </xs:complexType>

  <xs:simpleType name="serverpreview:ST_MAN">
    <xs:restriction base="t:ST_FileName">
      <xs:pattern value=".+\.(man)"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="serverpreview:ST_Dll">
    <xs:restriction base="t:ST_FileName">
      <xs:pattern value=".+\.(dll)"/>
    </xs:restriction>
  </xs:simpleType>

  <!-- WindowsCapabilitiesManifestSchema_v2.xsd -->
  <xs:element name="wincap2:Extension" substitutionGroup="f:ApplicationExtensionChoice">
    <xs:complexType>
        <xs:attribute name="Category" type="t:ST_ApplicationExtensionCategory_Windows_Restricted_Party2" use="required"/>
        <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <!-- RestrictedCapabilitiesManifestSchema_v4 -->
  <xs:element name="rescap4:Extension" substitutionGroup="f:ExtensionChoice">
    <xs:complexType>
      <xs:choice minOccurs="0">
        <xs:element name="rescap4:PrimaryInteropAssemblies" type="rescap4:CT_PrimaryInteropAssemblies"/>
        <xs:element name="rescap4:ClassicAppCompatKeys" type="rescap4:CT_ClassicAppCompatKeys"/>
      </xs:choice>
      <xs:attribute name="Category" type="t:ST_PackageExtensionCategory_Restricted4" use="required"/>
      <xs:attributeGroup ref="t:ExtensionBaseAttributes"/>
    </xs:complexType>
  </xs:element>

  <xs:complexType name="rescap4:CT_PrimaryInteropAssemblies">
    <xs:sequence minOccurs="0" maxOccurs="10000">
      <xs:element name="rescap4:Redirect" minOccurs="0" maxOccurs="10000">
        <xs:complexType>
           <xs:attribute name="Version" type="t:ST_VersionDuoOrTrio" use="required"/>
           <xs:attribute name="AssemblyVersion" type="t:ST_VersionQuad" use="required"/>
           <xs:attribute name="PublicKey" type="ST_PublicKey" use="required"/>
           <xs:attribute name="MachineType" type="t:ST_Architecture" use="required"/>
           <xs:attribute name="TargetClrVersion" type="t:ST_VersionDuoOrTrio" use="required"/>
           <xs:attribute name="FolderPath" type="t:ST_FileName" use="required"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="AssemblyName" type="t:ST_NonEmptyString" use="required"/>
    <xs:attribute name="AssemblyVersion" type="t:ST_VersionQuad" use="required"/>
    <xs:attribute name="PublicKey" type="rescap4:ST_PublicKey" use="required"/>
    <xs:attribute name="MachineType" type="t:ST_Architecture" use="required"/>
    <xs:attribute name="TargetClrVersion" type="t:ST_VersionDuoOrTrio" use="required"/>
    <xs:attribute name="Path" type="t:ST_FileName" use="required"/>
  </xs:complexType>
  
  <xs:simpleType name="rescap4:ST_PublicKey">
    <xs:restriction base="t:ST_NonEmptyString">
      <xs:pattern value="[0-9a-fA-F]+"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:complexType name="rescap4:CT_ClassicAppCompatKeys">
    <xs:sequence minOccurs="0" maxOccurs="10000">
      <xs:element name="rescap4:ClassicAppCompatKey" minOccurs="0" maxOccurs="10000">
        <xs:complexType>
           <xs:attribute name="Name" type="rescap4:ST_RegistryPath" use="required"/>
           <xs:attribute name="ValueName" type="xs:string"/>
           <xs:attribute name="ValueType" type="rescap4:ST_ValueType"/>
           <xs:attribute name="Value" type="xs:string"/>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>

  <xs:simpleType name="rescap4:ST_RegistryPath">
    <xs:restriction base="t:ST_NonEmptyString">
      <xs:pattern value="[hH][kK][eE][yY]_[cC][uU][rR][rR][eE][nN][tT]_[uU][sS][eE][rR]\\.+"/>
      <xs:pattern value="[hH][kK][eE][yY]_[lL][oO][cC][aA][lL]_[mM][aA][cC][hH][iI][nN][eE]\\[sS][oO][fF][tT][wW][aA][rR][eE]\\.+"/>
      <xs:pattern value="[hH][kK][eE][yY]_[uU][sS][eE][rR][sS]\\[sS][oO][fF][tT][wW][aA][rR][eE]\\.+"/>
      <xs:pattern value="[hH][kK][eE][yY]_[cC][uU][rR][rR][eE][nN][tT]_[cC][oO][nN][fF][iI][gG]\\[sS][oO][fF][tT][wW][aA][rR][eE]\\.+"/>
      <xs:pattern value="[hH][kK][cC][uU]\\.+"/>
      <xs:pattern value="[hH][kK][lL][mM]\\[sS][oO][fF][tT][wW][aA][rR][eE]\\.+"/>
      <xs:pattern value="[hH][kK][uU]\\[sS][oO][fF][tT][wW][aA][rR][eE]\\.+"/>
      <xs:pattern value="[hH][kK][cC][cC]\\[sS][oO][fF][tT][wW][aA][rR][eE]\\.+"/>
    </xs:restriction>
  </xs:simpleType>

  <xs:simpleType name="rescap4:ST_ValueType">
    <xs:restriction base="xs:string">
      <xs:enumeration value="REG_SZ"/>
      <xs:enumeration value="REG_BINARY"/>
      <xs:enumeration value="REG_DWORD"/>
      <xs:enumeration value="REG_QWORD"/>
      <xs:enumeration value="REG_MULTI_SZ"/>
      <xs:enumeration value="REG_EXPAND_SZ"/>
    </xs:restriction>
  </xs:simpleType>
</xs:schema>
